# Setting Up

To get your development environment setup, you'll need to have installed the following:
- [cargo](https://crates.io/), the package manager for Rust
- [wasm-pack](https://github.com/rustwasm/wasm-pack), for working with rust generated WebAssembly
- [mdbook](https://rust-lang.github.io/mdBook/), if working on mdbook-morsels plugin

## Commands

After you have installed the above dependencies, and cloned the repository, run `npm run setup` to install npm-related dependencies. This command also symlinks the all npm packages locally, including the ones generated by wasm-pack.

# Documentation Updates

Simply run `npm run devDocsFull` to build the project and launch the mdBook development server at `localhost:8000`.

# Developing


## Test Files

You'll need to source a suitable set of html, json, or csv files that is loadable by one of the command-line [loaders](./indexer/indexing.md#mapping-file-data-to-fields-loader_configs). The data in the collection should be mappable to the [fields](./indexer/fields.md) required by `@morsels/search-ui` for easy testing.

The test collection I used for the majority of development is a `380mb` csv corpus for example, in the following format.

```
"date", | "title",                 | "content",              | "court"
----------------------------------------------------------------------------------------
unused, | mapped to 'title' field, | mapped to 'body' field, | mapped to 'heading' field
```

Once you have your test files, place them under the `<project-root>/test_files/1/source` directory. If using a custom file format, you will likely need to configure the [data and field mappings](./indexer/fields.md) as well. You can run `cargo run -p morsels_indexer <project-root>/test_files/1/source --config-init` to create the default configuration file as a template, and proceed from there.

Alternatively, there are some small amount of files used for e2e testing already set up. Simply copy the files from `e2e/input` to `1/source`, and rename one of the `morsels_config_X.json` configuration files to `morsels_config.json`.

## Building and Running the Development Site

Once you have you test files placed in the correct folder per the previous chapter, run the `npm run index1R` script to index your content.

Then, use the `npm run dev` script to open the development site on port `8080`. This script runs the webpack build process, which in turn triggers the WebAssembly build process as well through the wasm-pack webpack plugin.

There are also `npm run index2R/3R` scripts available. An interactive script may be added in the future, but for now 2 should suffice (1 to test a smaller site, 1 to test a very large collection). There are a few buttons in the development site to switch between the folders quickly.
