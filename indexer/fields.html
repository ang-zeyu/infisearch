<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js morsels-theme">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Fields - Morsels Documentation</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../src/morsels-theme.css">

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "morsels-theme";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('morsels-theme')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../search_features.html"><strong aria-hidden="true">2.</strong> Search Features</a></li><li class="chapter-item expanded "><a href="../getting_started.html"><strong aria-hidden="true">3.</strong> Getting Started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../getting_started_mdbook.html"><strong aria-hidden="true">3.1.</strong> mdBook</a></li><li class="chapter-item expanded "><a href="../getting_started_others.html"><strong aria-hidden="true">3.2.</strong> Others</a></li></ol></li><li class="chapter-item expanded "><a href="../search_configuration.html"><strong aria-hidden="true">4.</strong> Search UI</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../search_configuration_styling.html"><strong aria-hidden="true">4.1.</strong> Styling</a></li><li class="chapter-item expanded "><a href="../search_configuration_renderers.html"><strong aria-hidden="true">4.2.</strong> Altering HTML outputs</a></li></ol></li><li class="chapter-item expanded "><a href="../indexer_configuration.html"><strong aria-hidden="true">5.</strong> Indexer</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../indexer/fields.html" class="active"><strong aria-hidden="true">5.1.</strong> Fields</a></li><li class="chapter-item expanded "><a href="../indexer/language.html"><strong aria-hidden="true">5.2.</strong> Language</a></li><li class="chapter-item expanded "><a href="../indexer/indexing.html"><strong aria-hidden="true">5.3.</strong> Indexing</a></li><li class="chapter-item expanded "><a href="../indexer/presets.html"><strong aria-hidden="true">5.4.</strong> Scaling Presets</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../tradeoffs.html"><strong aria-hidden="true">5.4.1.</strong> Tradeoffs</a></li></ol></li><li class="chapter-item expanded "><a href="../incremental_indexing.html"><strong aria-hidden="true">5.5.</strong> Incremental Indexing</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                    </div>

                    <h1 class="menu-title">Morsels Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/ang-zeyu/morsels" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>


                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <link rel="stylesheet" href="/morsels/morsels_assets/search-ui-light.css">
<style>.light .morsels-root,
.rust .morsels-root,
.coal .morsels-root,
.navy .morsels-root,
.ayu .morsels-root {
    --morsels-box-shadow: none;
    --morsels-border: 3px solid var(--table-header-bg);
    --morsels-bg: var(--bg);
    --morsels-triangle-bg: var(--table-header-bg);
    --morsels-item-box-shadow: 0 1px 5px rgba(196, 192, 187, 0.8);
    --morsels-item-sub-border: 0;
    --morsels-title-fg: var(--fg);
    --morsels-title-bg: var(--table-header-bg);
    --morsels-title-hover-fg: var(--fg);
    --morsels-title-hover-bg: var(--table-header-bg);
    --morsels-heading-fg: var(--fg);
    --morsels-heading-bg: var(--table-alternate-bg);
    --morsels-heading-hover-fg: var(--fg);
    --morsels-heading-hover-bg: var(--table-header-bg);
    --morsels-body-fg: var(--fg);
    --morsels-body-bg: var(--bg);
    --morsels-body-hover-fg: var(--fg);
    --morsels-body-hover-bg: var(--table-alternate-bg);
    --morsels-highlight: var(--search-mark-bg);
    --morsels-highlight-bg: none;
    --morsels-error-fg: var(--fg);
    --morsels-fine-print-fg: var(--fg);
    --morsels-loading-bg: var(--fg);
    --morsels-loading-secondary-bg: var(--fg);
    --morsels-scrollbar-bg: var(--sidebar-bg);
    --morsels-scrollbar-thumb-bg: var(--sidebar-non-existant);
    --morsels-fs-input-focus-outline: 3px solid var(--searchbar-shadow-color);
    --morsels-fs-border: 3px solid var(--sidebar-bg);
    --morsels-fs-box-shadow: none;
    --morsels-fs-header-bg: var(--sidebar-bg);
    --morsels-fs-header-border-bottom: none;
    --morsels-fs-header-close-fg: var(--sidebar-fg);
    --morsels-fs-header-close-bg: var(--sidebar-bg);
    --morsels-fs-header-close-hover-bg: var(--table-header-bg);
    --morsels-fs-header-close-hover-fg: var(--fg);
    --morsels-fs-header-close-active-bg: var(--table-header-bg);
    --morsels-fs-header-close-active-fg: var(--fg);
    --morsels-tip-bg: var(--sidebar-bg);
    --morsels-tip-fg: var(--sidebar-fg);
    --morsels-tip-code-fg: var(--inline-code-color);
    --morsels-tip-code-bg: transparent;
    --morsels-tip-icon-bg: rgb(230, 230, 230);
    --morsels-tip-icon-fg: rgb(80, 80, 80);
}

.ayu .morsels-root,
.rust .morsels-root {
    --morsels-fs-header-close-hover-bg: var(--sidebar-bg);
    --morsels-fs-header-close-hover-fg: white;
    --morsels-fs-header-close-active-bg: var(--sidebar-bg);
    --morsels-fs-header-close-active-fg: white;
    --morsels-tip-code-fg: var(--search-mark-bg) !important;
    --morsels-tip-icon-bg: rgb(200, 200, 200);
    --morsels-tip-icon-fg: rgb(50, 50, 50);
}

.morsels-theme .morsels-root .morsels-tip-item code,
.rust .morsels-root .morsels-tip-item code {
    color: var(--morsels-tip-code-fg) !important;;
}

.coal .morsels-root,
.navy .morsels-root,
.ayu .morsels-root {
    --morsels-item-box-shadow: 0 1px 5px rgb(50, 50, 50);
}

#morsels-search {
    width: 100%;
    border-radius: 6px;
    box-sizing: border-box;
    font-size: 15px;
    padding: 0.5em 0.75em;
    border: 1px solid var(--searchbar-border-color);
    background: var(--searchbar-bg);
    color: var(--searchbar-fg);
}

@media print {
    #morsels-search {
        display: none;
    }
}

#morsels-mdbook-target {
    list-style: none;
    margin: 0;
    padding: 0;
}
</style>
<p><input
    type="search"
    id="morsels-search"
    placeholder="Search"
/></p>
<p><span style="font-weight: 600;"><!--preload weight 600--></span></p>
<ul class="morsels-root" id="morsels-mdbook-target"></ul>
<h1 id="fields_config"><a class="header" href="#fields_config"><code>fields_config</code></a></h1>
<p>The first step to indexing any documents is defining the fields to store.</p>
<p>The default configurations are as follows, already setup for interfacing with the <code>@morsels/search-ui</code> package.</p>
<p>If you are using morsels’ search UI <strong>as-is</strong> (e.g. not adding additional fields to display), you can likely skip configuring <code>fields_config.fields</code>.</p>
<p>You may want to briefly take note of the other parameters under <code>fields_config</code> however, which can be used to adjust response times / file bloat. The possible adjustments are discussed later in <a href="../tradeoffs.html">Tradeoffs</a>.</p>
<pre><code class="language-json">{
  &quot;fields_config&quot;: {
    &quot;cache_all_field_stores&quot;: true,
    &quot;field_store_block_size&quot;: 10000,
    &quot;num_stores_per_dir&quot;: 1000,
    &quot;fields&quot;: [
      {
        &quot;name&quot;: &quot;title&quot;,
        &quot;do_store&quot;: false,
        &quot;weight&quot;: 2.0,
        &quot;k&quot;: 1.2,
        &quot;b&quot;: 0.15
      },
      {
        &quot;name&quot;: &quot;heading&quot;,
        &quot;do_store&quot;: false,
        &quot;weight&quot;: 1.5,
        &quot;k&quot;: 1.2,
        &quot;b&quot;: 0.25
      },
      {
        &quot;name&quot;: &quot;body&quot;,
        &quot;do_store&quot;: false,
        &quot;weight&quot;: 1.0,
        &quot;k&quot;: 1.2,
        &quot;b&quot;: 0.75
      },
      {
        &quot;name&quot;: &quot;headingLink&quot;,
        &quot;do_store&quot;: false,
        &quot;weight&quot;: 0.0,
        &quot;k&quot;: 1.2,
        &quot;b&quot;: 0.75
      },
      // Internal, hardcoded field (see &quot;Special Fields&quot;)
      {
        &quot;name&quot;: &quot;_relative_fp&quot;,
        &quot;do_store&quot;: true,
        &quot;weight&quot;: 0.0,
        &quot;k&quot;: 1.2,
        &quot;b&quot;: 0.75
      }
    ]
  }
}
</code></pre>
<p><strong><code>field_store_block_size</code>, <code>num_stores_per_dir</code>, and <code>do_store</code></strong></p>
<p>Morsels stores fields that have <code>do_store: true</code> specified in the field configuration into a json file in the output folder.</p>
<p>At search time, the fields saved in this manner from the json files are retrieved for result preview generation.</p>
<p>The <code>field_store_block_size</code> parameter controls how many documents to store in one such json file. Batching multiple files together if the fields stored are small can lead to less files and better browser caching. The <code>num_stores_per_dir</code> parameter controls how many json files should be stored together in one directory.</p>
<blockquote>
<p>⚠️ Ensure <code>field_store_block_size</code> is a clean multiple or divisor of the <code>num_docs_per_block</code> parameter elaborated under <a href="./indexing.html">indexing</a> later.<br>
This is a rather arbitiary limitation chosen to reduce the field store indexing scheme complexity,
but should work well enough for most use cases.</p>
</blockquote>
<p><strong><code>cache_all_field_stores</code></strong></p>
<p>This is the same as the configuration option under <a href="../search_configuration.html#search-library-options">search configuration</a>.
If both are specified, the value specified in the <code>initMorsels</code> call will take priority.</p>
<p>All fields specified with <code>do_store=true</code> would be cached up front on initialisation of the search library.</p>
<p>Its usage alongside other options is discussed in more detail under the chapter <a href="../tradeoffs.html">Tradeoffs</a>.</p>
<p><strong><code>weight</code></strong></p>
<p>This parameter is a boost / penalty multiplied to a individual field’s score.</p>
<p>Specifying <code>0.0</code> will result in the field not being indexed (although, it can still be stored for retrieval using <code>do_store</code>).</p>
<p><strong><code>k</code> &amp; <code>b</code></strong></p>
<p>These are Okapi BM25 model parameters. The following <a href="https://www.elastic.co/guide/en/elasticsearch/guide/current/pluggable-similarites.html#bm25-tunability">article</a> provides a good overview on how to configure these if the defaults are unsuitable for your use case.</p>
<h2 id="default-fields-in-morselssearch-ui"><a class="header" href="#default-fields-in-morselssearch-ui">Default Fields in <code>@morsels/search-ui</code></a></h2>
<p>The functions of the default fields for the user interface are as follows:</p>
<img alt="annotation for fields" src="../images/fields_annotated.png" />
<ul>
<li><code>title</code>: This is the header for a single document match. </li>
<li><code>heading</code>: These are section headers which appear on the left of corresponding <code>body</code> fields. THey are sourced from <code>&lt;h1-6&gt;</code> tags by default.</li>
<li><code>headingLink</code>: These are the <code>id</code> attributes of corresponding <code>&lt;h1-6&gt;</code> tags. If available, an <code>#anchor</code> is attached to the linked document for the particular heading</li>
<li><code>body</code>: This field is the text that appears to the right of headings (or on its own if there is no corresponding heading).</li>
<li><code>_relative_fp</code> <strong>or</strong> <code>link</code>: If the <code>title</code> field is missing for any document, this field takes its place in the header. It is also used to link to the source document (in the <code>&lt;a /&gt;</code> tag) or for generating result previews (more <a href="../search_configuration.html#default-rendering-output--purpose">here</a>).
<ul>
<li>Note: The <code>link</code> field is not setup by default; The combination of <code>sourceFilesUrl</code> + <code>_relative_fp</code> serves the same purpose. The <code>link</code> field serves to accomodate more custom use cases (e.g. linking to another site, or linking to a HTML page by indexing a json document).</li>
</ul>
</li>
</ul>
<h2 id="mapping-file-data-to-fields"><a class="header" href="#mapping-file-data-to-fields">Mapping File Data to Fields</a></h2>
<p>Defining fields is all good, but you may also need a way to map custom-formatted file data to each of these fields if the default mappings are insufficient. This is discussed later under <a href="./indexing.html#mapping-file-data-to-fields-loader_configs">indexing</a>.</p>
<p>The exception are “special” fields below, which sources data from elsewhere.</p>
<h3 id="special-fields"><a class="header" href="#special-fields">Special Fields</a></h3>
<p><strong><code>_relative_fp</code></strong></p>
<p>This is a “hardcoded” field generated by the indexer, in that its value is fixed as the relative file path from your source folder path to the file.</p>
<p>It is included in the default configuration to allow <code>@morsels/search-ui</code> to retrieve the source file for result preview generation, and to link to the document itself (via an <code>&lt;a&gt;&lt;/a&gt;</code> tag). You may refer back to <a href="../search_configuration.html#options-for-generating-result-previews">this section</a> for more details.</p>
<p>If this is removed, this field simply won’t be indexed nor stored.</p>
<script src="/morsels/morsels_assets/search-ui.bundle.js" type="text/javascript" charset="utf-8"></script>
<script src="/morsels/morsels_assets/mark.min.js" type="text/javascript" charset="utf-8"></script>
<script>
const base_url = '/morsels/';
const mode = (function () {
                // This IIFE is documentation specific, for demoing the different modes.
                // It would be the string mode (e.g. 'target') normally
                const params = new URLSearchParams(window.location.search);
                return params.get('mode') || 'target';
            })();
initMorsels({
  searcherOptions: {
    url: base_url + 'morsels_output/',
  },
  uiOptions: {
    mode,
    dropdownAlignment: 'bottom-start',
    target: document.getElementById('morsels-mdbook-target'),
    sourceFilesUrl: base_url,
    resultsRenderOpts: {
      addSearchedTerms: 'search',
    },
  },
});

document.getElementById('morsels-search').addEventListener('keydown', (ev) => {
  if (['ArrowLeft', 'ArrowRight'].includes(ev.key)) {
    ev.stopPropagation(); // used in global listener to change pages
    return;
  }
});

if (window.location.search) {
  // Adapted from the original searcher.js for mdbook
  // https://github.com/rust-lang/mdBook/blob/master/src/theme/searcher/searcher.js
  const target = document.getElementById('content');
  const marker = new Mark(target);

  function doSearchOrMarkFromUrl() {
    // Check current URL for search request
    var url = new URL(window.location.href);
    var urlParams = new URLSearchParams(url.search);

    if (urlParams.has('search')) {
      var words = JSON.parse(decodeURIComponent(urlParams.get('search')));
      marker.mark(words);

      var markers = document.querySelectorAll('mark');
      function hide() {
        for (var i = 0; i < markers.length; i++) {
          markers[i].classList.add('fade-out');
          window.setTimeout(function () { marker.unmark(); }, 300);
        }
      }
      for (var i = 0; i < markers.length; i++) {
        markers[i].addEventListener('click', hide);
      }
    }
  }
  doSearchOrMarkFromUrl();
}
</script>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../indexer_configuration.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../indexer/language.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../indexer_configuration.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../indexer/language.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>



        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="../src/morsels-theme.js"></script>


    </body>
</html>
