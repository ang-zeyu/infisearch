<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js rust">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Search UI Configuration - Morsels Documentation</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="src/morsels-theme.css">
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "rust";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="how_it_works.html"><strong aria-hidden="true">2.</strong> How it Works</a></li><li class="chapter-item expanded "><a href="search_features.html"><strong aria-hidden="true">3.</strong> Search Features</a></li><li class="chapter-item expanded "><a href="getting_started.html"><strong aria-hidden="true">4.</strong> Getting Started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="getting_started_mdbook.html"><strong aria-hidden="true">4.1.</strong> mdbook-morsels</a></li></ol></li><li class="chapter-item expanded "><a href="search_configuration.html" class="active"><strong aria-hidden="true">5.</strong> Search UI Configuration</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="search_configuration_renderers.html"><strong aria-hidden="true">5.1.</strong> Renderers</a></li></ol></li><li class="chapter-item expanded "><a href="indexing_configuration.html"><strong aria-hidden="true">6.</strong> Indexing Configuration</a></li><li class="chapter-item expanded "><a href="dynamic_indexing.html"><strong aria-hidden="true">7.</strong> Dynamic Indexing</a></li><li class="chapter-item expanded "><a href="future_plans.html"><strong aria-hidden="true">8.</strong> Future Plans</a></li><li class="chapter-item expanded "><a href="contributing.html"><strong aria-hidden="true">9.</strong> Contributing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="developers_setting_up.html"><strong aria-hidden="true">9.1.</strong> Setting Up</a></li><li class="chapter-item expanded "><a href="developers_developing.html"><strong aria-hidden="true">9.2.</strong> Developing</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                    </div>

                    <h1 class="menu-title">Morsels Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/ang-zeyu/morsels" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <script src="/morsels/morsels_assets/search-ui.bundle.js" type="text/javascript" charset="utf-8"></script><link rel="stylesheet" href="/morsels/morsels_assets/search-ui.css">
<style>
.morsels-root {
    --morsels-border: 3px solid var(--table-header-bg);
    --morsels-fg: var(--fg);
    --morsels-bg: var(--bg);
    --morsels-item-border-radius: 10px;
    --morsels-item-sub-border:  1px solid var(--table-border-color);
    --morsels-dropdown-input-separator-bg: var(--table-header-bg);
    --morsels-title-bg: var(--table-header-bg);
    --morsels-title-hover-fg: var(--bg);
    --morsels-title-hover-bg: var(--fg);
    --morsels-heading-bg: var(--table-alternate-bg);
    --morsels-heading-hover-bg: var(--table-header-bg);
    --morsels-body-hover-bg: var(--table-alternate-bg);
    --morsels-highlight: var(--search-mark-bg);
    --morsels-fine-print-fg: var(--fg);
    --morsels-loading-bg: var(--fg);
    --morsels-scrollbar-bg: var(--sidebar-bg);
    --morsels-scrollbar-thumb-bg: var(--sidebar-non-existant);
    --morsels-fullscreen-box-shadow: none;
    --morsels-fullscreen-header-bg: var(--sidebar-bg);
    --morsels-fullscreen-input-border: 2px solid var(--searchbar-border-color);
    --morsels-fullscreen-input-focus-border: 2px solid var(--searchbar-border-color);
    --morsels-fullscreen-input-focus-box-shadow: 0 0 5px var(--searchbar-shadow-color);
    --morsels-fullscreen-header-close-fg: var(--sidebar-fg);
    --morsels-fullscreen-header-close-bg: var(--sidebar-non-existant);
    --morsels-fullscreen-header-close-hover-bg: var(--theme-popup-border);
    --morsels-fullscreen-header-close-hover-fg: var(--sidebar-spacer);
    --morsels-fullscreen-header-close-active-bg: var(--theme-popup-border);
    --morsels-fullscreen-header-close-active-fg: var(--sidebar-spacer);
}
</style>
<p><input
    type="text"
    id="morsels-search"
    placeholder="Search"
    style="width: 100%; border-radius: 5px; font-size: 16px; padding: 0.5em 0.75em; border: 1px solid var(--searchbar-border-color); background: var(--searchbar-bg); color: var(--searchbar-fg); outline: none;"
/></p>
<h1 id="search-configuration"><a class="header" href="#search-configuration">Search Configuration</a></h1>
<p>All search time related options can be provided through the <code>initMorsels</code> function, exposed by <code>@morsels/search-ui</code>.</p>
<h2 id="forenotes"><a class="header" href="#forenotes">Forenotes</a></h2>
<h3 id="fullscreen-pop-up-and-dropdown-ui-versions"><a class="header" href="#fullscreen-pop-up-and-dropdown-ui-versions">Fullscreen Pop-Up and Dropdown UI Versions</a></h3>
<p>The search UI provides 2 different interfaces, a dropdown and fullscreen / “popup” version.</p>
<p>The dropdown version is used for desktop devices by default, which is attached to the element specified by <code>inputId</code>.
For mobile devices, the fullscreen version is used instead.</p>
<h3 id="default-rendering-output--purpose"><a class="header" href="#default-rendering-output--purpose">Default Rendering Output / Purpose</a></h3>
<p>It is also worth rehashing that the default result generation assumes the simple but common use case of <strong>linking to a source document</strong> (<code>&lt;a /&gt;</code> tag). </p>
<p>This is achieved through an internal <code>_relative_fp</code> field that is stored during indexing, and retrieved during search time. The combination of <code>sourceFilesUrl</code> + <code>_relative_fp</code> forms the full source document link, which is used for:</p>
<ul>
<li>Attaching a link to the source document in the generated result match</li>
<li>Retrieving the source document (see “From Source Documents”)</li>
</ul>
<p>Therefore, source documents are assumed to be available. You may refer to the section on <a href="#generating-result-previews">generating</a> result previews otherwise.</p>
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<p>The available options and their format in this page are detailed in the following code block. Options which warrant more explanation are also elaborated in the subsequent sections of this page.</p>
<pre><code class="language-js">initMorsels({
    // Options belonging to @morsels/search-lib, the search library package
    searcherOptions: {
        // Base url of output directory from cli tool
        url: 'http://192.168.10.132:3000/output/',
        
        // Whether to use substring query term expansion
        numberOfExpandedTerms: 3,
        
        // Override for using query term proximity ranking or not.
        // Disabled for mobile devices by default
        useQueryTermProximity: true,
    },
    
    // Options for @morsels/search-ui, the user interface package
    
    // Id of input element to attach the search dropdown to
    inputId: 'morsels-search',

    // Debounce time for the input handlers
    inputDebounce: isMobile ? 275 : 200,
    
    // Mandatory, by default - base url for sourcing .html / .json files
    sourceFilesUrl: 'http://192.168.10.132:3000/source/',
    
    // Customise search result outputs, UI behaviour
    render: {
        // refer to Renderers section
    }
});
</code></pre>
<h2 id="basic-user-interface-behaviours"><a class="header" href="#basic-user-interface-behaviours">Basic User Interface Behaviours</a></h2>
<p>This section details the available options, necessary inputs and some utility methods controlling the some user interface behaviour.</p>
<p>The subsequent section on <a href="./search_configuration_renderers.html">renderers</a> provides a more advanced API (that really shouldn’t be needed) to customise the html output. If you have a configuration use case that cannot be achieved without these APIs, and you think should be included as a simpler configuration option here, feel free to raise a feature request on Github!</p>
<pre><code class="language-ts">{
    inputId?: string,
    render: {
        enablePortal?: boolean | 'auto',
        portalTo?: HTMLElement,
        // ...
    }
}
</code></pre>
<p><strong><code>inputId</code></strong></p>
<p>This option tells morsels which input element to use for the <strong>dropdown version</strong> of its search ui.</p>
<p>If this is unspecified, the <code>show / hide</code> APIs below must be used to bring up the <strong>fullscreen UI</strong>.</p>
<p><strong><code>enablePortal = 'auto'</code></strong></p>
<p>This parameter tells morsels whether to use the fullscreen search UI for mobile devices when the original <code>&lt;input&gt;</code> specified by <code>inputId</code> is focused.</p>
<p>The default value of <code>'auto'</code> configures this according to mobile device detection (<code>true</code> if it is a mobile device), and also adds a simple window resize handler to automatically hide the corresponding UI if the window is resized.</p>
<p>You can set this to <code>true</code> / <code>false</code> to always prefer the fullscreen or dropdown version instead when the original <code>&lt;input&gt;</code> is focused.</p>
<p>If <code>inputId</code> is unspecified, this option will not do anything.</p>
<p><strong><code>portalTo = document.getElementsByTagName('body')[0]</code></strong></p>
<p>This parameter tells morsels which element to attach the fullscreen search UI to, which uses <code>fixed</code> positioning.</p>
<p><strong><code>show() / hide()</code></strong></p>
<pre><code class="language-ts">const { show, hide } = initMorsels(/* ... */);
</code></pre>
<p>The default behaviour of showing the fullscreen search UI on focusing the input may be insufficient in some cases, for example showing the UI when clicking a search icon.</p>
<p>You may call the <code>show()</code> function returned by the initMorsels call in such a case for manual control. Correspondingly, the <code>hide()</code> method hides the fullscreen interface, although, this shouldn’t be needed since there’s a close button is available by default.</p>
<h2 id="term-expansion"><a class="header" href="#term-expansion">Term Expansion</a></h2>
<p>(<code>numberOfExpandedTerms</code>)</p>
<p>By default, stemming is turned off in the <a href="indexing_configuration.html#language">language modules</a>. This does mean a bigger dictionary (but not that much anyway), and lower recall, but much more precise searches.</p>
<p>To provide a compromise for recall, query terms that are similar to the searched term are added to the query, although with a lower weight.</p>
<p>This is only applied for the last term (if any) of a query, and if the query string immediately ends with that term (e.g. no whitespace after it).
You may also think of this as implicit wildcard search for the last query term.</p>
<h2 id="term-proximity-ranking"><a class="header" href="#term-proximity-ranking">Term Proximity Ranking</a></h2>
<p>(<code>useQueryTermProximity</code>)</p>
<p>Document scores are also scaled by how close query expressions or terms are to each other, if positions are indexed.
This may be costly for mobile devices however, and is disabled by default in such cases.</p>
<h2 id="generating-result-previews"><a class="header" href="#generating-result-previews">Generating Result Previews</a></h2>
<p>(<code>sourceFilesUrl</code>)</p>
<p>There are two ways to generate result previews, the first of the below being the default.</p>
<p>Unless you have modified the default result renderer (covered in the renderers page), morsels requires <strong>at least</strong> one of the <code>body</code> / <code>heading</code> / <code>title</code> fields (covered in the next section on indexing configuration).</p>
<h3 id="1-from-source-documents-default"><a class="header" href="#1-from-source-documents-default">1. From Source Documents (default)</a></h3>
<p>When the below option (field stores) is not configured or unavailable, and this parameter is specified, morsels will attempt to fetch the source document from <code>sourceFilesUrl</code> adjoined with the relative file path of the document at the time of indexing. The source document is then reparsed, and its fields are extracted again in order to generate result previews.</p>
<p>Also note that this option is only applicable for indexed html and json files at this time!</p>
<p>As csv files are often used to hold multiple documents (and can therefore get very large), it is unsuitable to be used as a source for search result previews. In this case, the subsequent section details the alternative method of generating result previews.</p>
<h3 id="2-from-field-stores"><a class="header" href="#2-from-field-stores">2. From Field Stores</a></h3>
<p>If source documents are unavailable (or if you wish to use this method anyway), morsels is able to generate result previews from the field stores generated at indexing time.</p>
<p>In order to specify what fields to store, please take a look at the <code>do_store</code> option in this <a href="./indexing_configuration.html#fields_config">section</a> of the indexing configuration page. To use this method of result preview generation for the default use case / result rendering behaviour, simply enable the <code>do_store</code> option for the <code>heading</code>, <code>body</code>, and <code>title</code> fields.</p>
<p>You may also wish to use this method even if source documents are available, if filesystem bloat isn’t too much of a concern. Apart from avoiding the additional http requests, the internal json field store comes packed in a format that is more performant for search-ui to perform result preview generation on.</p>
<h3 id="alternative-rendering-outputs"><a class="header" href="#alternative-rendering-outputs">Alternative Rendering Outputs</a></h3>
<p>If this the default use case is insufficient (or if source documents are unavailable), you would need to create your own result <a href="./search_configuration_renderers.html">renderer</a> to achieve the expected behaviour you want (for example, to call a function when a user clicks the result preview). Nevertheless, the section <a href="#from-field-stores">“From Field Stores”</a> above would still be relevant and provides the basis for retrieving a document’s fields.</p>
<h2 id="mobile-device-detection"><a class="header" href="#mobile-device-detection">Mobile Device Detection</a></h2>
<p>It may helpful to note that mobile devices are detected through a simple <code>window.matchMedia('only screen and (max-width: 1024px)').matches</code> query at initialisation time, which may not be accurate.</p>
<p>This is used for determining some default settings, namely:</p>
<ul>
<li>Query term proximity ranking is disabled</li>
<li>The input debounce time, which is slightly longer for mobile devices</li>
<li>Whether to use the fullscreen “portal”-ed version of the user interface instead</li>
</ul>
<p>Overrides may be provided through the options above if this detection method is inadequate.</p>
<script>
    initMorsels({
        searcherOptions: {
          url: '/morsels/morsels_output/',
        },
        sourceFilesUrl: '/morsels/',
        render: {
            enablePortal: true,
            opts: {
                dropdownAlignment: 'left'
            }
        }
    });
</script>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="getting_started_mdbook.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="search_configuration_renderers.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="getting_started_mdbook.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="search_configuration_renderers.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="src/morsels-theme.js"></script>
    </body>
</html>
