!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.initMorsels=t():e.initMorsels=t()}(self,(function(){return(()=>{"use strict";var e={m:{},d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},u:e=>"search.worker.bundle.js"};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var o=n.getElementsByTagName("script");o.length&&(t=o[o.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})(),e.b=document.baseURI||self.location.href;var t={};function n(e){return e.split("-")[0]}function o(e){return e.split("-")[1]}function r(e){return["top","bottom"].includes(n(e))?"x":"y"}function s(e){return"y"===e?"height":"width"}function i(e,t,i){let{reference:l,floating:a}=e;const c=l.x+l.width/2-a.width/2,d=l.y+l.height/2-a.height/2,u=r(t),f=s(u),h=l[f]/2-a[f]/2,p="x"===u;let m;switch(n(t)){case"top":m={x:c,y:l.y-a.height};break;case"bottom":m={x:c,y:l.y+l.height};break;case"right":m={x:l.x+l.width,y:d};break;case"left":m={x:l.x-a.width,y:d};break;default:m={x:l.x,y:l.y}}switch(o(t)){case"start":m[u]-=h*(i&&p?-1:1);break;case"end":m[u]+=h*(i&&p?-1:1)}return m}e.d(t,{default:()=>De});function l(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}function a(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}async function c(e,t){var n;void 0===t&&(t={});const{x:o,y:r,platform:s,rects:i,elements:c,strategy:d}=e,{boundary:u="clippingAncestors",rootBoundary:f="viewport",elementContext:h="floating",altBoundary:p=!1,padding:m=0}=t,g=l(m),y=c[p?"floating"===h?"reference":"floating":h],w=a(await s.getClippingRect({element:null==(n=await(null==s.isElement?void 0:s.isElement(y)))||n?y:y.contextElement||await(null==s.getDocumentElement?void 0:s.getDocumentElement(c.floating)),boundary:u,rootBoundary:f,strategy:d})),b=a(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:"floating"===h?{...i.floating,x:o,y:r}:i.reference,offsetParent:await(null==s.getOffsetParent?void 0:s.getOffsetParent(c.floating)),strategy:d}):i[h]);return{top:w.top-b.top+g.top,bottom:b.bottom-w.bottom+g.bottom,left:w.left-b.left+g.left,right:b.right-w.right+g.right}}const d=Math.min,u=Math.max;function f(e,t,n){return u(e,d(t,n))}const h=e=>({name:"arrow",options:e,async fn(t){const{element:n,padding:o=0}=null!=e?e:{},{x:i,y:a,placement:c,rects:d,platform:u}=t;if(null==n)return{};const h=l(o),p={x:i,y:a},m=r(c),g=s(m),y=await u.getDimensions(n),w="y"===m?"top":"left",b="y"===m?"bottom":"right",v=d.reference[g]+d.reference[m]-p[m]-d.floating[g],x=p[m]-d.reference[m],R=await(null==u.getOffsetParent?void 0:u.getOffsetParent(n));let T=R?"y"===m?R.clientHeight||0:R.clientWidth||0:0;0===T&&(T=d.floating[g]);const C=v/2-x/2,O=h[w],k=T-y[g]-h[b],P=T/2-y[g]/2+C,E=f(O,P,k);return{data:{[m]:E,centerOffset:P-E}}}}),p={left:"right",right:"left",bottom:"top",top:"bottom"};function m(e){return e.replace(/left|right|bottom|top/g,(e=>p[e]))}function g(e,t,n){void 0===n&&(n=!1);const i=o(e),l=r(e),a=s(l);let c="x"===l?i===(n?"end":"start")?"right":"left":"start"===i?"bottom":"top";return t.reference[a]>t.floating[a]&&(c=m(c)),{main:c,cross:m(c)}}const y={start:"end",end:"start"};function w(e){return e.replace(/start|end/g,(e=>y[e]))}const b=["top","right","bottom","left"],v=(b.reduce(((e,t)=>e.concat(t,t+"-start",t+"-end")),[]),function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var o;const{placement:r,middlewareData:s,rects:i,initialPlacement:l,platform:a,elements:d}=t,{mainAxis:u=!0,crossAxis:f=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",flipAlignment:y=!0,...b}=e,v=n(r),x=h||(v!==l&&y?function(e){const t=m(e);return[w(e),t,w(t)]}(l):[m(l)]),R=[l,...x],T=await c(t,b),C=[];let O=(null==(o=s.flip)?void 0:o.overflows)||[];if(u&&C.push(T[v]),f){const{main:e,cross:t}=g(r,i,await(null==a.isRTL?void 0:a.isRTL(d.floating)));C.push(T[e],T[t])}if(O=[...O,{placement:r,overflows:C}],!C.every((e=>e<=0))){var k,P;const e=(null!=(k=null==(P=s.flip)?void 0:P.index)?k:0)+1,t=R[e];if(t)return{data:{index:e,overflows:O},reset:{placement:t}};let n="bottom";switch(p){case"bestFit":{var E;const e=null==(E=O.map((e=>[e,e.overflows.filter((e=>e>0)).reduce(((e,t)=>e+t),0)])).sort(((e,t)=>e[1]-t[1]))[0])?void 0:E[0].placement;e&&(n=e);break}case"initialPlacement":n=l}if(r!==n)return{reset:{placement:n}}}return{}}}});const x=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){const{placement:r,rects:s,platform:i,elements:l}=t,{apply:a,...d}=e,f=await c(t,d),h=n(r),p=o(r);let m,g;"top"===h||"bottom"===h?(m=h,g=p===(await(null==i.isRTL?void 0:i.isRTL(l.floating))?"start":"end")?"left":"right"):(g=h,m="end"===p?"top":"bottom");const y=u(f.left,0),w=u(f.right,0),b=u(f.top,0),v=u(f.bottom,0),x={availableHeight:s.floating.height-(["left","right"].includes(r)?2*(0!==b||0!==v?b+v:u(f.top,f.bottom)):f[m]),availableWidth:s.floating.width-(["top","bottom"].includes(r)?2*(0!==y||0!==w?y+w:u(f.left,f.right)):f[g])},R=await i.getDimensions(l.floating);null==a||a({...t,...x});const T=await i.getDimensions(l.floating);return R.width!==T.width||R.height!==T.height?{reset:{rects:!0}}:{}}}};function R(e){return e&&e.document&&e.location&&e.alert&&e.setInterval}function T(e){if(null==e)return window;if(!R(e)){const t=e.ownerDocument;return t&&t.defaultView||window}return e}function C(e){return T(e).getComputedStyle(e)}function O(e){return R(e)?"":e?(e.nodeName||"").toLowerCase():""}function k(){const e=navigator.userAgentData;return null!=e&&e.brands?e.brands.map((e=>e.brand+"/"+e.version)).join(" "):navigator.userAgent}function P(e){return e instanceof T(e).HTMLElement}function E(e){return e instanceof T(e).Element}function L(e){return"undefined"!=typeof ShadowRoot&&(e instanceof T(e).ShadowRoot||e instanceof ShadowRoot)}function S(e){const{overflow:t,overflowX:n,overflowY:o}=C(e);return/auto|scroll|overlay|hidden/.test(t+o+n)}function D(e){return["table","td","th"].includes(O(e))}function A(e){const t=/firefox/i.test(k()),n=C(e);return"none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||["transform","perspective"].includes(n.willChange)||t&&"filter"===n.willChange||t&&!!n.filter&&"none"!==n.filter}function M(){return!/^((?!chrome|android).)*safari/i.test(k())}const _=Math.min,I=Math.max,Q=Math.round;function W(e,t,n){var o,r,s,i;void 0===t&&(t=!1),void 0===n&&(n=!1);const l=e.getBoundingClientRect();let a=1,c=1;t&&P(e)&&(a=e.offsetWidth>0&&Q(l.width)/e.offsetWidth||1,c=e.offsetHeight>0&&Q(l.height)/e.offsetHeight||1);const d=E(e)?T(e):window,u=!M()&&n,f=(l.left+(u&&null!=(o=null==(r=d.visualViewport)?void 0:r.offsetLeft)?o:0))/a,h=(l.top+(u&&null!=(s=null==(i=d.visualViewport)?void 0:i.offsetTop)?s:0))/c,p=l.width/a,m=l.height/c;return{width:p,height:m,top:h,right:f+p,bottom:h+m,left:f,x:f,y:h}}function F(e){return(t=e,(t instanceof T(t).Node?e.ownerDocument:e.document)||window.document).documentElement;var t}function N(e){return E(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function j(e){return W(F(e)).left+N(e).scrollLeft}function $(e,t,n){const o=P(t),r=F(t),s=W(e,o&&function(e){const t=W(e);return Q(t.width)!==e.offsetWidth||Q(t.height)!==e.offsetHeight}(t),"fixed"===n);let i={scrollLeft:0,scrollTop:0};const l={x:0,y:0};if(o||!o&&"fixed"!==n)if(("body"!==O(t)||S(r))&&(i=N(t)),P(t)){const e=W(t,!0);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else r&&(l.x=j(r));return{x:s.left+i.scrollLeft-l.x,y:s.top+i.scrollTop-l.y,width:s.width,height:s.height}}function B(e){return"html"===O(e)?e:e.assignedSlot||e.parentNode||(L(e)?e.host:null)||F(e)}function H(e){return P(e)&&"fixed"!==getComputedStyle(e).position?e.offsetParent:null}function q(e){const t=T(e);let n=H(e);for(;n&&D(n)&&"static"===getComputedStyle(n).position;)n=H(n);return n&&("html"===O(n)||"body"===O(n)&&"static"===getComputedStyle(n).position&&!A(n))?t:n||function(e){let t=B(e);for(L(t)&&(t=t.host);P(t)&&!["html","body"].includes(O(t));){if(A(t))return t;t=t.parentNode}return null}(e)||t}function J(e){if(P(e))return{width:e.offsetWidth,height:e.offsetHeight};const t=W(e);return{width:t.width,height:t.height}}function U(e){const t=B(e);return["html","body","#document"].includes(O(t))?e.ownerDocument.body:P(t)&&S(t)?t:U(t)}function V(e,t){var n;void 0===t&&(t=[]);const o=U(e),r=o===(null==(n=e.ownerDocument)?void 0:n.body),s=T(o),i=r?[s].concat(s.visualViewport||[],S(o)?o:[]):o,l=t.concat(i);return r?l:l.concat(V(i))}function z(e,t,n){return"viewport"===t?a(function(e,t){const n=T(e),o=F(e),r=n.visualViewport;let s=o.clientWidth,i=o.clientHeight,l=0,a=0;if(r){s=r.width,i=r.height;const e=M();(e||!e&&"fixed"===t)&&(l=r.offsetLeft,a=r.offsetTop)}return{width:s,height:i,x:l,y:a}}(e,n)):E(t)?function(e,t){const n=W(e,!1,"fixed"===t),o=n.top+e.clientTop,r=n.left+e.clientLeft;return{top:o,left:r,x:r,y:o,right:r+e.clientWidth,bottom:o+e.clientHeight,width:e.clientWidth,height:e.clientHeight}}(t,n):a(function(e){var t;const n=F(e),o=N(e),r=null==(t=e.ownerDocument)?void 0:t.body,s=I(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),i=I(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0);let l=-o.scrollLeft+j(e);const a=-o.scrollTop;return"rtl"===C(r||n).direction&&(l+=I(n.clientWidth,r?r.clientWidth:0)-s),{width:s,height:i,x:l,y:a}}(F(e)))}function X(e){const t=V(e),n=["absolute","fixed"].includes(C(e).position)&&P(e)?q(e):e;return E(n)?t.filter((e=>E(e)&&function(e,t){const n=null==t||null==t.getRootNode?void 0:t.getRootNode();if(null!=e&&e.contains(t))return!0;if(n&&L(n)){let n=t;do{if(n&&e===n)return!0;n=n.parentNode||n.host}while(n)}return!1}(e,n)&&"body"!==O(e))):[]}const G={getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:o,strategy:r}=e;const s=[..."clippingAncestors"===n?X(t):[].concat(n),o],i=s[0],l=s.reduce(((e,n)=>{const o=z(t,n,r);return e.top=I(o.top,e.top),e.right=_(o.right,e.right),e.bottom=_(o.bottom,e.bottom),e.left=I(o.left,e.left),e}),z(t,i,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:t,offsetParent:n,strategy:o}=e;const r=P(n),s=F(n);if(n===s)return t;let i={scrollLeft:0,scrollTop:0};const l={x:0,y:0};if((r||!r&&"fixed"!==o)&&(("body"!==O(n)||S(s))&&(i=N(n)),P(n))){const e=W(n,!0);l.x=e.x+n.clientLeft,l.y=e.y+n.clientTop}return{...t,x:t.x-i.scrollLeft+l.x,y:t.y-i.scrollTop+l.y}},isElement:E,getDimensions:J,getOffsetParent:q,getDocumentElement:F,getElementRects:e=>{let{reference:t,floating:n,strategy:o}=e;return{reference:$(t,q(n),o),floating:{...J(n),x:0,y:0}}},getClientRects:e=>Array.from(e.getClientRects()),isRTL:e=>"rtl"===C(e).direction};const Y=(e,t,n)=>(async(e,t,n)=>{const{placement:o="bottom",strategy:r="absolute",middleware:s=[],platform:l}=n,a=await(null==l.isRTL?void 0:l.isRTL(t));let c=await l.getElementRects({reference:e,floating:t,strategy:r}),{x:d,y:u}=i(c,o,a),f=o,h={};for(let n=0;n<s.length;n++){const{name:p,fn:m}=s[n],{x:g,y,data:w,reset:b}=await m({x:d,y:u,initialPlacement:o,placement:f,strategy:r,middlewareData:h,rects:c,platform:l,elements:{reference:e,floating:t}});d=null!=g?g:d,u=null!=y?y:u,h={...h,[p]:{...h[p],...w}},b&&("object"==typeof b&&(b.placement&&(f=b.placement),b.rects&&(c=!0===b.rects?await l.getElementRects({reference:e,floating:t,strategy:r}):b.rects),({x:d,y:u}=i(c,f,a))),n=-1)}return{x:d,y:u,placement:f,strategy:r,middlewareData:h}})(e,t,{platform:G,...n});const K=class{constructor(e,t,n,o,r){this.query=e,this.searchedTerms=t,this.queryParts=n,this.getNextN=o,this.free=r}};var Z=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{a(o.next(e))}catch(e){s(e)}}function l(e){try{a(o.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}a((o=o.apply(e,t||[])).next())}))};const ee=class{constructor(e,t,n){this.docId=e,this.score=t,this.fieldInfos=n,this.storage=Object.create(null)}populate(e,t,n){return Z(this,void 0,void 0,(function*(){const{fieldStoreBlockSize:o,numStoresPerDir:r,indexingConfig:s}=n,{numDocsPerBlock:i}=s,l=Math.floor(this.docId/o),a=Math.floor(this.docId/i),c=Math.floor(l/r),d=`${e}field_store/${c}/${l}--${a}.json`;try{const e=yield t.fetch(d);let n=this.docId%o;i<o&&(n%=i),this.storage=e[n]}catch(e){console.log(e)}}))}getSingleField(e){const t=this.fieldInfos.find((t=>t.name===e));if(!t)return"";const n=this.storage.find((e=>e[0]===t.id));return n?n[1]:""}getStorageWithFieldNames(){return this.storage.map((e=>{const t=e.map((e=>e));return t[0]=this.fieldInfos[t[0]].name,t}))}};class te{constructor(){this.linkToJsons=Object.create(null)}fetch(e){return this.linkToJsons[e]||(this.linkToJsons[e]=fetch(e).then((e=>e.json()))),this.linkToJsons[e]}}var ne=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{a(o.next(e))}catch(e){s(e)}}function l(e){try{a(o.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}a((o=o.apply(e,t||[])).next())}))};const oe=class{constructor(t){this.options=t,this.isSetupDone=!1,this.workerQueryPromises=Object.create(null),this.nextId=0,this.worker=new Worker(new URL(e.p+e.u(658),e.b));const n=new Promise((e=>{this.worker.onmessage=t=>{if(t.data.isSetupDone)e();else if(t.data.query){const{query:e,queryId:n,nextResults:o,searchedTerms:r,queryParts:s}=t.data;this.workerQueryPromises[e][n].resolve({query:e,nextResults:o,searchedTerms:r,queryParts:s})}},this.worker.onmessageerror=e=>{console.log(e)}}));this.setupPromise=this.retrieveConfig().then((()=>{t.useQueryTermProximity=t.useQueryTermProximity&&this.morselsConfig.indexingConfig.withPositions,this.worker.postMessage(this.morselsConfig)})).then((()=>this.cacheFieldStores())).then((()=>n)).then((()=>this.isSetupDone=!0))}cacheFieldStores(){return ne(this,void 0,void 0,(function*(){if(!this.options.cacheAllFieldStores)return;this.persistentJsonCache=new te;const e=[],t=Math.ceil(this.morselsConfig.lastDocId/this.morselsConfig.fieldStoreBlockSize),{numStoresPerDir:n,indexingConfig:o}=this.morselsConfig,{numDocsPerBlock:r}=o;for(let o=0;o<t;o++){const t=Math.floor(o/n),s=Math.min(this.morselsConfig.lastDocId,(o+1)*this.morselsConfig.fieldStoreBlockSize);for(let n=o*this.morselsConfig.fieldStoreBlockSize;n<s;n+=r){const s=Math.floor(n/r),i=`${this.options.url}field_store/${t}/${o}--${s}.json`;if(e.push([i,fetch(i).then((e=>e.json()))]),e.length>=10){const t=e.shift();this.persistentJsonCache.linkToJsons[t[0]]=yield t[1]}}}const s=yield Promise.all(e.map((e=>e[1])));e.forEach(((e,t)=>{this.persistentJsonCache.linkToJsons[e[0]]=s[t]}))}))}retrieveConfig(){return ne(this,void 0,void 0,(function*(){const e=yield(yield fetch(`${this.options.url}morsels_config.json`,{method:"GET",headers:{"Content-Type":"application/json"}})).json();if("0.0.11"!==e.ver)throw new Error("Morsels search version not equal to indexer version!");"cacheAllFieldStores"in this.options||(this.options.cacheAllFieldStores=!!e.cache_all_field_stores);const{field_infos:t}=e,n=[];Object.entries(t.field_infos_map).forEach((([e,t])=>{t.name=e,n.push(t)})),n.sort(((e,t)=>e.id-t.id)),this.morselsConfig={lastDocId:e.last_doc_id,indexingConfig:{loaderConfigs:e.indexing_config.loader_configs,plNamesToCache:e.indexing_config.pl_names_to_cache,numDocsPerBlock:e.indexing_config.num_docs_per_block,numPlsPerDir:e.indexing_config.num_pls_per_dir,withPositions:e.indexing_config.with_positions},langConfig:e.lang_config,fieldInfos:n,numScoredFields:t.num_scored_fields,fieldStoreBlockSize:t.field_store_block_size,numStoresPerDir:t.num_stores_per_dir,searcherOptions:this.options}}))}deleteQuery(e,t){delete this.workerQueryPromises[e][t],0===Object.keys(this.workerQueryPromises[e]).length&&delete this.workerQueryPromises[e]}getQuery(e){return ne(this,void 0,void 0,(function*(){yield this.setupPromise;const t=this.nextId;this.nextId+=1,this.workerQueryPromises[e]=this.workerQueryPromises[e]||{},this.workerQueryPromises[e][t]={promise:void 0,resolve:void 0},this.workerQueryPromises[e][t].promise=new Promise((n=>{this.workerQueryPromises[e][t].resolve=n,this.worker.postMessage({query:e,queryId:t})}));const n=yield this.workerQueryPromises[e][t].promise;return new K(e,n.searchedTerms,n.queryParts,(n=>ne(this,void 0,void 0,(function*(){if(!this.workerQueryPromises[e]||!this.workerQueryPromises[e][t])return[];if(yield this.workerQueryPromises[e][t].promise,this.workerQueryPromises[e][t].promise=new Promise((o=>{this.workerQueryPromises[e][t].resolve=o,this.worker.postMessage({query:e,queryId:t,isGetNextN:!0,n})})),!this.workerQueryPromises[e]||!this.workerQueryPromises[e][t])return[];const o=(yield this.workerQueryPromises[e][t].promise).nextResults.map((([e,t])=>new ee(e,t,this.morselsConfig.fieldInfos))),r=this.persistentJsonCache||new te;return yield Promise.all(o.map((e=>e.populate(this.options.url,r,this.morselsConfig)))),o}))),(()=>{this.deleteQuery(e,t),this.worker.postMessage({query:e,isFree:!0})}))}))}};function re(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function se(e,t,...n){const o=document.createElement(e);return Object.entries(t).forEach((([e,t])=>{o.setAttribute(e,t)})),n.forEach((e=>{if("string"==typeof e){const t=document.createElement("span");t.textContent=e,o.appendChild(t)}else o.appendChild(e)})),o}const ie=se,le="data-morsels-loading-indicator";function ae(){return se("div",{[le]:"true"})}function ce(e){return e.startsWith("/")?new URL(new URL(window.location.href).origin+e):new URL(e)}var de=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{a(o.next(e))}catch(e){s(e)}}function l(e){try{a(o.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}a((o=o.apply(e,t||[])).next())}))};const ue=new DOMParser,fe="_relative_fp";function he(e,t){const n=t.map((t=>Array.from(e.matchAll(t))));if(!n.some((e=>e.length)))return{str:e,lastClosestTermLengths:[],lastClosestWindowPositions:[],numberTermsMatched:0};let o=t.map((()=>-1e8)),r=1e8,s=t.map((()=>0));const i=n.map((()=>0)),l=n.map((e=>!e.length)),a=n.map((()=>0)),c=n.map((()=>-1));for(;;){let e,t=1e10,d=1e10,u=0,f=!1,h=!0;for(let o=0;o<i.length;o++){const r=n[o][i[o]];if(!r)continue;const s=r[2];s.length>a[o]&&(f=!0,a[o]=s.length),h=h&&s.length===a[o];const p=r.index;!l[o]&&p<d&&(d=p,e=o),t=Math.min(t,p),u=Math.max(u,p),c[o]=p}const p=u-t;if((f||h&&p<r)&&(r=p,o=[...c],s=i.map(((e,t)=>n[t][e]&&n[t][e][0].length))),void 0===e)break;if(i[e]+=1,i[e]>=n[e].length&&(l[e]=!0,i[e]-=1,!l.some((e=>!e))))break}const d=o.map(((e,t)=>({pos:e,idx:t}))).filter((e=>e.pos>=0)).sort(((e,t)=>e.pos-t.pos)),u=d.length;return{str:e,lastClosestWindowPositions:d,lastClosestTermLengths:s,numberTermsMatched:u}}function pe(){return ie("span",{class:"morsels-ellipsis","aria-label":"ellipses"}," ... ")}function me(e,t,n){const{highlightRender:o}=n.uiOptions.resultsRenderOpts,{str:r,lastClosestWindowPositions:s,lastClosestTermLengths:i}=e;if(!s.some((({pos:e})=>e>=0)))return t?[r.trimStart().substring(0,80),pe()]:[r];const l=[];let a=0;for(const{pos:e,idx:c}of s){const s=e+i[c];if(e>a+80)t&&l.push(pe()),l.push(r.substring(e-40,e)),l.push(o(ie,n,r.substring(e,s)));else if(e>=a)l.pop(),l.push(r.substring(a,e)),l.push(o(ie,n,r.substring(e,s)));else{if(!(s>a))continue;l.pop();l[l.length-1].textContent+=r.substring(a,s)}l.push(r.substring(s,s+40)),a=s}return t&&l.push(pe()),l}function ge(e,t,n,o){const{bodyOnlyRender:r,headingBodyRender:s}=o.uiOptions.resultsRenderOpts;let i,l={itemIdx:-100,fieldText:""},a=[];for(let n=0;n<e.length;n+=1){const[o,r]=e[n];if("headingLink"===o){l={itemIdx:n,fieldText:r};continue}const s=he(r,t);if("heading"===o)i=s,i.itemIdx=n,i.headingLink=l.itemIdx===i.itemIdx-1?l.fieldText:"",a.push({str:"",lastClosestTermLengths:[],lastClosestWindowPositions:[],numberTermsMatched:-2e3,headingMatch:i,headingLink:i.headingLink,itemIdx:n});else if("body"===o){const e=s;i?(e.headingMatch=i,e.headingLink=i.headingLink,e.numberTermsMatched+=i.numberTermsMatched):e.numberTermsMatched-=1e3,a.push(e)}}a.sort(((e,t)=>e.numberTermsMatched===t.numberTermsMatched&&0===e.numberTermsMatched?t.str.length-e.str.length:t.numberTermsMatched-e.numberTermsMatched));const c=[],d=Math.min(a.length,2);for(let e=0;e<d&&a[e].numberTermsMatched==a[0].numberTermsMatched;e+=1)c.push(a[e]);return c.map((e=>{const t=me(e,!0,o);if(e.headingMatch){const r=me(e.headingMatch,!1,o),i=r.length?r:[e.headingMatch.str],l=e.headingLink&&`${n}#${e.headingLink}`;return s(ie,o,i,t,l)}return r(ie,o,t)}))}const ye=new Set([fe,"title","link"]);function we(e,t,n,o,r,s,i){return de(this,void 0,void 0,(function*(){const{loaderConfigs:r}=n.indexingConfig,l=e.getStorageWithFieldNames();let a,c,d;for(const e of l){const[t,n]=e;switch(t){case"link":a=n;break;case fe:c=n;break;case"title":d=n}if(a&&c&&d)break}const u="string"==typeof t.uiOptions.sourceFilesUrl,f=a||u&&c&&`${t.uiOptions.sourceFilesUrl}${c}`||"";d=d||c||a;let h,p=f;if(t.uiOptions.resultsRenderOpts.addSearchedTerms&&f){const e=ce(f);e.searchParams.append(t.uiOptions.resultsRenderOpts.addSearchedTerms,s),p=e.toString()}if(o)h=ge(l.filter((e=>!ye.has(e[0]))),i,p,t);else if(f)if(f.endsWith(".html")&&r.HtmlLoader){const e=yield(yield fetch(f)).text(),n=ue.parseFromString(e,"text/html"),{title:o,bodies:s}=function(e,t,n,o,r){const s=[];if(t.exclude_selectors)for(const n of t.exclude_selectors){const t=e.querySelectorAll(n);for(let e=0;e<t.length;e+=1)t[e].remove()}t.selectors=t.selectors||[];const i=t.selectors.map((e=>e.selector)).join(",");!function e(n,o){for(const e of t.selectors)if(n.matches(e.selector)){Object.entries(e.attr_map).forEach((([e,t])=>{n.attributes[e]&&s.push([t,n.attributes[e].value])})),o=e.field_name;break}if(n.querySelector(i))for(let t=0;t<n.childNodes.length;t+=1){const r=n.childNodes[t];r.nodeType===Node.ELEMENT_NODE?e(r,o):r.nodeType===Node.TEXT_NODE&&o&&(s.length&&s[s.length-1][0]===o?s[s.length-1][1]+=r.data:s.push([o,r.data]))}else o&&(s.length&&s[s.length-1][0]===o?s[s.length-1][1]+=n.textContent:s.push([o,n.textContent||""]))}(e.documentElement,void 0);const l=s.find((e=>"title"===e[0]));let a="";return l&&([,a]=l,l[1]=""),{title:a,bodies:ge(s,n,o,r)}}(n,r.HtmlLoader,i,p,t);d=o||d,h=s}else if(f.endsWith(".txt")&&r.TxtLoader){h=ge([["body",yield(yield fetch(f)).text()]],i,p,t)}else{const e=ce(f);if(e.pathname.endsWith(".json")&&r.JsonLoader){const n=yield(yield fetch(f)).json(),{title:o,bodies:s}=function(e,t,n,o,r){const s=[],{field_map:i,field_order:l}=t,a=Object.entries(i).find((([,e])=>"title"===e)),c=a&&a[0];for(const t of l)t!==c&&e[t]&&s.push([i[t],e[t]]);return{title:c&&e[c],bodies:ge(s,n,o,r)}}(e.hash?n[e.hash.substring(1)]:n,r.JsonLoader,i,p,t);d=o||d,h=s}}else h=[];return t.uiOptions.resultsRenderOpts.listItemRender(ie,t,s,f,d,h,l)}))}function be(e,t,n,o,r){const s=[],i=[];for(const e of r.searchedTerms){const t=e.map((e=>(i.push(e),`(${re(e)})`))).sort(((e,t)=>t.length-e.length)).join("|");if("ascii"===n.langConfig.lang){const e=new RegExp(`(^|\\W|_)(${t})(?=\\W|$)`,"gi");s.push(e)}else if("latin"===n.langConfig.lang){const e=new RegExp(`(^|\\W|_)(${t}\\W?)`,"gi");s.push(e)}else if("chinese"===n.langConfig.lang){const e=new RegExp(`()(${t})`,"gi");s.push(e)}}const l=n.fieldInfos.find((e=>e.do_store&&("body"===e.name||"title"===e.name||"heading"===e.name)));return Promise.all(o.map((e=>we(e,t,n,l,0,JSON.stringify(i),s))))}function ve(e,t,n,o,r,s,i){return de(this,void 0,void 0,(function*(){if(t!==e.currQuery)return;const l=i.uiOptions.loadingIndicatorRender(ie,i,!1,!1);o||r.appendChild(l),e.lastElObserver&&e.lastElObserver.disconnect();const a=document.createDocumentFragment();(o?i.uiOptions.termInfoRender(ie,i,t.queryParts):[]).forEach((e=>a.appendChild(e)));const c=yield t.getNextN(i.uiOptions.resultsPerPage);if(t!==e.currQuery)return;const d=yield i.uiOptions.resultsRender(ie,i,n,c,t);if(t!==e.currQuery)return;d.length?d.forEach((e=>a.appendChild(e))):o&&a.appendChild(i.uiOptions.noResultsRender(ie,i));const u=a.lastElementChild;o?(r.innerHTML="",s.v=ae(),r.append(s.v),r.append(a)):l.replaceWith(a),d.length&&(e.lastElObserver=new IntersectionObserver(((o,l)=>de(this,void 0,void 0,(function*(){o[0].isIntersecting&&(l.unobserve(u),yield ve(e,t,n,!1,r,s,i))}))),{rootMargin:"10px 10px 10px 10px"}),e.lastElObserver.observe(u))}))}var xe;!function(e){e.Auto="auto",e.Dropdown="dropdown",e.Fullscreen="fullscreen",e.Target="target"}(xe||(xe={}));class Re{constructor(){this.isRunningNewQuery=!1}}var Te=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{a(o.next(e))}catch(e){s(e)}}function l(e){try{a(o.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}a((o=o.apply(e,t||[])).next())}))};let Ce=!1,Oe=!1,ke=!1;function Pe(e){return e.mode===xe.Auto&&!Ce||e.mode===xe.Dropdown}function Ee(e,t,n){e.setAttribute("role","combobox"),e.setAttribute("aria-expanded","true"),e.setAttribute("aria-owns",t.getAttribute("id")),t.setAttribute("role","listbox"),t.setAttribute("aria-label",n),t.setAttribute("aria-live","polite")}function Le(e,t){e.setAttribute("aria-autocomplete","list"),e.setAttribute("aria-controls",t),e.setAttribute("aria-activedescendant","morsels-list-selected")}function Se(e,t,n,o){const{uiOptions:r}=o;let s={v:ae()};const i=new Re;function l(l){var a;return Te(this,void 0,void 0,(function*(){try{null===(a=i.currQuery)||void 0===a||a.free(),i.currQuery=yield n.getQuery(l),yield ve(i,i.currQuery,n.morselsConfig,!0,t,s,o),e.scrollTo({top:0}),t.scrollTo({top:0})}catch(e){throw console.error(e),t.innerHTML="",t.appendChild(r.errorRender(ie,o)),e}finally{if(i.nextQuery){const e=i.nextQuery;i.nextQuery=void 0,yield e()}else i.isRunningNewQuery=!1}}))}let a=-1,c=!0;return d=>{const u=r.preprocessQuery(d.target.value);if(clearTimeout(a),u.length)a=setTimeout((()=>{if(c)t.innerHTML="",s.v=r.loadingIndicatorRender(ie,o,!n.isSetupDone,!0),t.appendChild(s.v),n.isSetupDone||n.setupPromise.then((()=>{const e=r.loadingIndicatorRender(ie,o,!n.isSetupDone,c);s.v.replaceWith(e),s.v=e})),Pe(r)&&r.showDropdown(e,t,o);else{const e=r.loadingIndicatorRender(ie,o,!n.isSetupDone,!1);s.v.replaceWith(e),s.v=e}i.isRunningNewQuery?i.nextQuery=()=>l(u):(i.isRunningNewQuery=!0,l(u)),c=!1}),r.inputDebounce);else{const n=()=>{r.mode===xe.Target?t.innerHTML="":Pe(r)?r.hideDropdown(e,t,o):(t.innerHTML="",t.appendChild(r.fsBlankRender(ie,o))),i.isRunningNewQuery=!1,c=!0};i.isRunningNewQuery?i.nextQuery=n:n()}}}const De=function(e){const t=e.isMobileDevice||(()=>window.matchMedia("only screen and (max-width: 1024px)").matches);Ce=t(),function(e){if(e.searcherOptions=e.searcherOptions||{},!("url"in e.searcherOptions))throw new Error("Mandatory url parameter not specified");e.searcherOptions.url.endsWith("/")||(e.searcherOptions.url+="/"),"numberOfExpandedTerms"in e.searcherOptions||(e.searcherOptions.numberOfExpandedTerms=3),"useQueryTermProximity"in e.searcherOptions||(e.searcherOptions.useQueryTermProximity=!Ce),"resultLimit"in e.searcherOptions||(e.searcherOptions.resultLimit=null),e.uiOptions=e.uiOptions||{};const{uiOptions:t}=e;if(t.sourceFilesUrl&&!t.sourceFilesUrl.endsWith("/")&&(t.sourceFilesUrl+="/"),t.mode=t.mode||xe.Auto,t.mode===xe.Target&&("string"==typeof t.target&&(t.target=document.getElementById(t.target)),!t.target))throw new Error("'target' mode specified but no valid target option specified");if("input"in t&&"string"!=typeof t.input||(t.input=document.getElementById(t.input||"morsels-search")),[xe.Dropdown,xe.Target].includes(t.mode)&&!t.input)throw new Error("'dropdown' or 'target' mode specified but no input element found");"inputDebounce"in t||(t.inputDebounce=100),t.preprocessQuery||(t.preprocessQuery=e=>e),"string"==typeof t.fsContainer&&(t.fsContainer=document.getElementById(t.fsContainer)),"dropdownAlignment"in t||(t.dropdownAlignment="bottom-end"),t.fsContainer||(t.fsContainer=document.getElementsByTagName("body")[0]),"resultsPerPage"in t||(t.resultsPerPage=8);const n=t.showDropdown||((e,n)=>{if(n.childElementCount){const o=e.lastElementChild,r=o.firstElementChild;o.style.display="block",Y(e,o,{placement:t.dropdownAlignment,middleware:[v({padding:10,mainAxis:!1}),x({apply({availableWidth:e,availableHeight:t}){Object.assign(n.style,{maxWidth:`min(${e}px, var(--morsels-dropdown-max-width))`,maxHeight:`min(${t}px, var(--morsels-dropdown-max-height))`})},padding:10}),h({element:r})]}).then((({x:e,y:t,middlewareData:n})=>{Object.assign(o.style,{left:`${e}px`,top:`${t}px`});const{x:s}=n.arrow;Object.assign(r.style,{left:null!=s?`${s}px`:""})}))}});t.showDropdown=(...e)=>{n(...e),Oe=!0};const o=t.hideDropdown||(e=>{e.lastElementChild.style.display="none"});t.hideDropdown=(...e)=>{o(...e),Oe=!1};const r=t.showFullscreen||((e,t,n)=>{n.appendChild(e);const o=e.querySelector("input.morsels-fs-input");o&&o.focus()});t.showFullscreen=(e,t,...n)=>{r(e,t,...n);const o=t.querySelector(".focus");o&&t.scrollTo({top:o.offsetTop-t.offsetTop-30}),ke=!0};const s=t.hideFullscreen||(e=>{e.remove()});t.hideFullscreen=(...e)=>{s(...e),ke=!1},t.label=t.label||"Search this site",t.fsPlaceholder=t.fsPlaceholder||"Search this site...",t.fsCloseText=t.fsCloseText||"Close",t.dropdownRootRender=t.dropdownRootRender||((e,n,o)=>{const r=e("div",{class:"morsels-inner-root",style:"display: none;"}),s=e("div",{class:"morsels-root"},o,r);r.appendChild(e("div",{class:`morsels-input-dropdown-separator ${t.dropdownAlignment}`})),Le(o,"morsels-dropdown-list");const i=e("ul",{id:"morsels-dropdown-list",class:"morsels-list"});return r.appendChild(i),Ee(s,i,n.uiOptions.label),{dropdownRoot:s,dropdownListContainer:i}}),t.fsRootRender=t.fsRootRender||((e,n,o)=>{const r=e("div",{class:"morsels-root morsels-fs-root"});r.onclick=e=>e.stopPropagation(),r.onmousedown=e=>e.stopPropagation();const s=e("div",{class:"morsels-fs-backdrop"},r),i=e("label",{id:"morsels-fs-label",for:"morsels-fs-input",style:"display: none"},n.uiOptions.label),l=e("input",{class:"morsels-fs-input",type:"search",placeholder:n.uiOptions.fsPlaceholder,autocomplete:"false","aria-labelledby":"morsels-fs-label"});Le(l,"morsels-fs-list");const a=e("button",{class:"morsels-input-close-fs"},n.uiOptions.fsCloseText);a.onclick=e=>{e.preventDefault(),o()},r.appendChild(e("form",{class:"morsels-fs-input-button-wrapper"},i,l,a));const c=e("ul",{id:"morsels-fs-list",class:"morsels-list","aria-labelledby":"morsels-fs-label"});return r.appendChild(c),Ee(r,c,n.uiOptions.label),s.addEventListener("mousedown",(()=>{t.hideFullscreen(s,c,r,n)})),s.addEventListener("keyup",(e=>{"Escape"===e.code&&(e.stopPropagation(),t.hideFullscreen(s,c,r,n))})),{root:s,listContainer:c,input:l}}),t.errorRender=t.errorRender||(e=>e("div",{class:"morsels-error"},"Oops! Something went wrong... 🙁")),t.noResultsRender=t.noResultsRender||(e=>e("div",{class:"morsels-no-results"},"No results found")),t.fsBlankRender=t.fsBlankRender||(e=>e("div",{class:"morsels-fs-blank"},"Start Searching Above!")),t.loadingIndicatorRender||(t.loadingIndicatorRender=(e,t,n,o)=>{const r=e("span",{class:"morsels-loading-indicator"});if(n){const t=e("div",{class:"morsels-initialising-text"},"... Initialising ...");return e("div",{class:"morsels-initialising"},t,r)}return o||r.classList.add("morsels-loading-indicator-subsequent"),r});const i=t.loadingIndicatorRender;t.loadingIndicatorRender=(...e)=>{const t=i(...e);return t.setAttribute(le,"true"),t},t.termInfoRender=t.termInfoRender||(()=>[]),t.resultsRender=t.resultsRender||be,t.resultsRenderOpts=t.resultsRenderOpts||{},t.resultsRenderOpts.listItemRender=t.resultsRenderOpts.listItemRender||((t,n,o,r,s,i)=>{const l=t("a",{class:"morsels-link"},t("div",{class:"morsels-title"},s),...i);if(r){let t=r;if(n.uiOptions.resultsRenderOpts.addSearchedTerms){const n=ce(r);n.searchParams.append(e.uiOptions.resultsRenderOpts.addSearchedTerms,o),t=n.toString()}l.setAttribute("href",t)}return t("li",{class:"morsels-list-item",role:"option"},l)}),t.resultsRenderOpts.headingBodyRender=t.resultsRenderOpts.headingBodyRender||((e,t,n,o,r)=>{const s=e("a",{class:"morsels-heading-body"},e("div",{class:"morsels-heading"},...n),e("div",{class:"morsels-bodies"},e("div",{class:"morsels-body"},...o)));return r&&s.setAttribute("href",r),s}),t.resultsRenderOpts.bodyOnlyRender=t.resultsRenderOpts.bodyOnlyRender||((e,t,n)=>e("div",{class:"morsels-body"},...n)),t.resultsRenderOpts.highlightRender=t.resultsRenderOpts.highlightRender||((e,t,n)=>e("span",{class:"morsels-highlight"},n)),e.otherOptions=e.otherOptions||{}}(e);const{uiOptions:n}=e,o=new oe(e.searcherOptions),{root:r,listContainer:s,input:i}=n.fsRootRender(ie,e,(()=>n.hideFullscreen(r,s,n.fsContainer,e)));let l;i.addEventListener("input",Se(r,s,o,e)),s.appendChild(n.fsBlankRender(ie,e));const{input:a}=n;if(!a||n.mode!==xe.Auto&&n.mode!==xe.Dropdown){if(a&&n.mode===xe.Fullscreen)a.addEventListener("focus",(()=>{n.showFullscreen(r,s,n.fsContainer,e)}));else if(a&&n.mode===xe.Target){a.addEventListener("input",Se(n.target,n.target,o,e));let t=n.target.getAttribute("id");t||(n.target.setAttribute("id","morsels-target-list"),t="morsels-target-list"),Le(a,t),Ee(a,n.target,n.label)}}else{const i=a.parentElement;a.remove();const{dropdownRoot:c,dropdownListContainer:d}=n.dropdownRootRender(ie,e,a);function u(){n.hideDropdown(c,l,e),document.activeElement===a&&n.showDropdown(c,l,e)}let f;l=d,i.appendChild(c),a.addEventListener("input",Se(c,l,o,e)),window.addEventListener("resize",(()=>{clearTimeout(f),f=setTimeout((()=>{n.mode!==xe.Dropdown?(Ce=t(),Ce?n.hideDropdown(c,l,e):(n.hideFullscreen(r,s,n.fsContainer,e),u())):u()}),10)})),a.addEventListener("blur",(()=>{Pe(n)&&setTimeout((()=>{let t=document.activeElement;for(;t;)if(t=t.parentElement,t===c)return void a.focus();n.hideDropdown(c,l,e)}),100)})),a.addEventListener("focus",(()=>{Pe(n)?n.showDropdown(c,l,e):n.showFullscreen(r,s,n.fsContainer,e)}))}function c(e){if(!["ArrowDown","ArrowUp","Home","End","Enter"].includes(e.key))return;let t,o=e=>{t.scrollTo({top:e.offsetTop-t.offsetTop-30})};if(Pe(n)){if(!Oe)return;t=l}else if(n.mode===xe.Target)t=n.target,o=e=>{e.scrollIntoView({block:"center"})};else{if(!ke)return;t=s}const r=t.querySelector(".focus");function i(e){r&&(r.classList.remove("focus"),r.removeAttribute("aria-selected"),r.removeAttribute("id")),e.classList.add("focus"),e.setAttribute("aria-selected","true"),e.setAttribute("id","morsels-list-selected"),o(e)}function a(e,t){e&&!e.getAttribute(le)?i(e):t&&!t.getAttribute(le)&&i(t)}const c=t.firstElementChild,d=t.lastElementChild;if("ArrowDown"===e.key)r?a(r.nextElementSibling,null):a(c,null==c?void 0:c.nextElementSibling);else if("ArrowUp"===e.key)r&&a(r.previousElementSibling,null);else if("Home"===e.key)a(c,null==c?void 0:c.nextElementSibling);else if("End"===e.key)a(d,null==d?void 0:d.previousElementSibling);else if("Enter"===e.key&&r){const e=r.querySelector("a[href]");e&&(window.location.href=e.getAttribute("href"))}e.preventDefault()}return null==a||a.addEventListener("keydown",c),i.addEventListener("keydown",c),{showFullscreen:()=>{n.showFullscreen(r,s,n.fsContainer,e)},hideFullscreen:()=>{n.hideFullscreen(r,s,n.fsContainer,e)}}};return t=t.default})()}));