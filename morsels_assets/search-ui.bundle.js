!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.initMorsels=t():e.initMorsels=t()}(self,(function(){return(()=>{"use strict";var e={m:{},d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},u:e=>"search.worker.bundle.js"};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var o=n.getElementsByTagName("script");o.length&&(t=o[o.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})(),e.b=document.baseURI||self.location.href;var t={};function n(e){return e.split("-")[0]}function o(e){return e.split("-")[1]}function r(e){return["top","bottom"].includes(n(e))?"x":"y"}function s(e){return"y"===e?"height":"width"}function i(e){let{reference:t,floating:i,placement:l}=e;const c=t.x+t.width/2-i.width/2,a=t.y+t.height/2-i.height/2;let d;switch(n(l)){case"top":d={x:c,y:t.y-i.height};break;case"bottom":d={x:c,y:t.y+t.height};break;case"right":d={x:t.x+t.width,y:a};break;case"left":d={x:t.x-i.width,y:a};break;default:d={x:t.x,y:t.y}}const u=r(l),f=s(u);switch(o(l)){case"start":d[u]=d[u]-(t[f]/2-i[f]/2);break;case"end":d[u]=d[u]+(t[f]/2-i[f]/2)}return d}e.d(t,{default:()=>Te});function l(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}function c(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}async function a(e,t){void 0===t&&(t={});const{x:n,y:o,platform:r,rects:s,elements:i,strategy:a}=e,{boundary:d="clippingParents",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:h=!1,padding:p=0}=t,m=l(p),g=i[h?"floating"===f?"reference":"floating":f],y=await r.getClippingClientRect({element:await r.isElement(g)?g:g.contextElement||await r.getDocumentElement({element:i.floating}),boundary:d,rootBoundary:u}),w=c(await r.convertOffsetParentRelativeRectToViewportRelativeRect({rect:"floating"===f?{...s.floating,x:n,y:o}:s.reference,offsetParent:await r.getOffsetParent({element:i.floating}),strategy:a}));return{top:y.top-w.top+m.top,bottom:w.bottom-y.bottom+m.bottom,left:y.left-w.left+m.left,right:w.right-y.right+m.right}}const d={left:"right",right:"left",bottom:"top",top:"bottom"};function u(e){return e.replace(/left|right|bottom|top/g,(e=>d[e]))}function f(e,t){const n="start"===o(e),i=r(e),l=s(i);let c="x"===i?n?"right":"left":n?"bottom":"top";return t.reference[l]>t.floating[l]&&(c=u(c)),{main:c,cross:u(c)}}const h={start:"end",end:"start"};function p(e){return e.replace(/start|end/g,(e=>h[e]))}const m=["top","right","bottom","left"];m.reduce(((e,t)=>e.concat(t,t+"-start",t+"-end")),[]);const g=function(e){return void 0===e&&(e={}),{name:"flip",async fn(t){var o,r;const{placement:s,middlewareData:i,rects:l,initialPlacement:c}=t;if(null!=(o=i.flip)&&o.skip)return{};const{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:m,fallbackStrategy:g="bestFit",flipAlignment:y=!0,...w}=e,b=n(s),v=m||(b===c||!y?[u(c)]:function(e){const t=u(e);return[p(e),t,p(t)]}(c)),x=[c,...v],R=await a(t,w),T=[];let C=(null==(r=i.flip)?void 0:r.overflows)||[];if(d&&T.push(R[b]),h){const{main:e,cross:t}=f(s,l);T.push(R[e],R[t])}if(C=[...C,{placement:s,overflows:T}],!T.every((e=>e<=0))){var k,O;const e=(null!=(k=null==(O=i.flip)?void 0:O.index)?k:0)+1,t=x[e];if(t)return{data:{index:e,overflows:C},reset:{placement:t}};let n="bottom";switch(g){case"bestFit":{var P;const e=null==(P=C.slice().sort(((e,t)=>e.overflows.filter((e=>e>0)).reduce(((e,t)=>e+t),0)-t.overflows.filter((e=>e>0)).reduce(((e,t)=>e+t),0)))[0])?void 0:P.placement;e&&(n=e);break}case"initialPlacement":n=c}return{data:{skip:!0},reset:{placement:n}}}return{}}}};const y=function(e){return void 0===e&&(e=0),{name:"offset",fn(t){const{x:o,y:s,placement:i,rects:l}=t,c=function(e){let{placement:t,rects:o,value:s}=e;const i=n(t),l=["left","top"].includes(i)?-1:1,c="function"==typeof s?s({...o,placement:t}):s,{mainAxis:a,crossAxis:d}="number"==typeof c?{mainAxis:c,crossAxis:0}:{mainAxis:0,crossAxis:0,...c};return"x"===r(i)?{x:d,y:a*l}:{x:a*l,y:d}}({placement:i,rects:l,value:e});return{x:o+c.x,y:s+c.y,data:c}}}};const w=function(e){return void 0===e&&(e={}),{name:"size",async fn(t){var r;const{placement:s,rects:i,middlewareData:l}=t,{apply:c,...d}=e,u=await a(t,d),f=n(s),h="end"===o(s);let p,m;"top"===f||"bottom"===f?(p=f,m=h?"left":"right"):(m=f,p=h?"top":"bottom");const g={height:i.floating.height-u[p],width:i.floating.width-u[m]};return null!=(r=l.size)&&r.skip?{}:(null==c||c({...g,...i}),{data:{skip:!0},reset:!0})}}};function b(e){return"[object Window]"===(null==e?void 0:e.toString())}function v(e){if(null==e)return window;if(!b(e)){const t=e.ownerDocument;return t&&t.defaultView||window}return e}function x(e){return v(e).getComputedStyle(e)}function R(e){return b(e)?"":e?(e.nodeName||"").toLowerCase():""}function T(e){return e instanceof v(e).HTMLElement}function C(e){return e instanceof v(e).Element}function k(e){return e instanceof v(e).ShadowRoot||e instanceof ShadowRoot}function O(e){const{overflow:t,overflowX:n,overflowY:o}=x(e);return/auto|scroll|overlay|hidden/.test(t+o+n)}function P(e){return["table","td","th"].includes(R(e))}function E(e){const t=navigator.userAgent.toLowerCase().includes("firefox"),n=x(e);return"none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||["transform","perspective"].includes(n.willChange)||t&&"filter"===n.willChange||t&&!!n.filter&&"none"!==n.filter}function S(e,t){void 0===t&&(t=!1);const n=e.getBoundingClientRect();let o=1,r=1;return t&&T(e)&&(o=e.offsetWidth>0&&Math.round(n.width)/e.offsetWidth||1,r=e.offsetHeight>0&&Math.round(n.height)/e.offsetHeight||1),{width:n.width/o,height:n.height/r,top:n.top/r,right:n.right/o,bottom:n.bottom/r,left:n.left/o,x:n.left/o,y:n.top/r}}function L(e){return(t=e,(t instanceof v(t).Node?e.ownerDocument:e.document)||window.document).documentElement;var t}function M(e){return b(e)?{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}:{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function D(e){return S(L(e)).left+M(e).scrollLeft}function A(e,t,n){const o=T(t),r=L(t),s=S(e,o&&function(e){const t=S(e);return Math.round(t.width)!==e.offsetWidth||Math.round(t.height)!==e.offsetHeight}(t));let i={scrollLeft:0,scrollTop:0};const l={x:0,y:0};if(o||!o&&"fixed"!==n)if(("body"!==R(t)||O(r))&&(i=M(t)),T(t)){const e=S(t,!0);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else r&&(l.x=D(r));return{x:s.left+i.scrollLeft-l.x,y:s.top+i.scrollTop-l.y,width:s.width,height:s.height}}function _(e){return"html"===R(e)?e:e.assignedSlot||e.parentNode||(k(e)?e.host:null)||L(e)}function I(e){return T(e)&&"fixed"!==getComputedStyle(e).position?e.offsetParent:null}function Q(e){const t=v(e);let n=I(e);for(;n&&P(n)&&"static"===getComputedStyle(n).position;)n=I(n);return n&&("html"===R(n)||"body"===R(n)&&"static"===getComputedStyle(n).position&&!E(n))?t:n||function(e){let t=_(e);for(;T(t)&&!["html","body"].includes(R(t));){if(E(t))return t;t=t.parentNode}return null}(e)||t}function F(e){return{width:e.offsetWidth,height:e.offsetHeight}}function W(e){return["html","body","#document"].includes(R(e))?e.ownerDocument.body:T(e)&&O(e)?e:W(_(e))}function N(e,t){var n;void 0===t&&(t=[]);const o=W(e),r=o===(null==(n=e.ownerDocument)?void 0:n.body),s=v(o),i=r?[s].concat(s.visualViewport||[],O(o)?o:[]):o,l=t.concat(i);return r?l:l.concat(N(_(i)))}function j(e,t){return"viewport"===t?c(function(e){const t=v(e),n=L(e),o=t.visualViewport;let r=n.clientWidth,s=n.clientHeight,i=0,l=0;return o&&(r=o.width,s=o.height,Math.abs(t.innerWidth/o.scale-o.width)<.001&&(i=o.offsetLeft,l=o.offsetTop)),{width:r,height:s,x:i,y:l}}(e)):C(t)?function(e){const t=S(e),n=t.top+e.clientTop,o=t.left+e.clientLeft;return{top:n,left:o,x:o,y:n,right:o+e.clientWidth,bottom:n+e.clientHeight,width:e.clientWidth,height:e.clientHeight}}(t):c(function(e){var t;const n=L(e),o=M(e),r=null==(t=e.ownerDocument)?void 0:t.body,s=Math.max(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),i=Math.max(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0);let l=-o.scrollLeft+D(e);const c=-o.scrollTop;return"rtl"===x(r||n).direction&&(l+=Math.max(n.clientWidth,r?r.clientWidth:0)-s),{width:s,height:i,x:l,y:c}}(L(e)))}function $(e){const t=N(_(e)),n=["absolute","fixed"].includes(x(e).position),o=n&&T(e)?Q(e):e;return C(o)?t.filter((e=>C(e)&&function(e,t){const n=null==t.getRootNode?void 0:t.getRootNode();if(e.contains(t))return!0;if(n&&k(n)){let n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}(e,o)&&"body"!==R(e)&&(!n||"static"!==x(e).position))):[]}const B={getElementRects:e=>{let{reference:t,floating:n,strategy:o}=e;return{reference:A(t,Q(n),o),floating:{...F(n),x:0,y:0}}},convertOffsetParentRelativeRectToViewportRelativeRect:e=>function(e){let{rect:t,offsetParent:n,strategy:o}=e;const r=T(n),s=L(n);if(n===s)return t;let i={scrollLeft:0,scrollTop:0};const l={x:0,y:0};if((r||!r&&"fixed"!==o)&&(("body"!==R(n)||O(s))&&(i=M(n)),T(n))){const e=S(n,!0);l.x=e.x+n.clientLeft,l.y=e.y+n.clientTop}return{...t,x:t.x-i.scrollLeft+l.x,y:t.y-i.scrollTop+l.y}}(e),getOffsetParent:e=>{let{element:t}=e;return Q(t)},isElement:e=>C(e),getDocumentElement:e=>{let{element:t}=e;return L(t)},getClippingClientRect:e=>function(e){let{element:t,boundary:n,rootBoundary:o}=e;const r=[..."clippingParents"===n?$(t):[].concat(n),o],s=r[0],i=r.reduce(((e,n)=>{const o=j(t,n);return e.top=Math.max(o.top,e.top),e.right=Math.min(o.right,e.right),e.bottom=Math.min(o.bottom,e.bottom),e.left=Math.max(o.left,e.left),e}),j(t,s));return i.width=i.right-i.left,i.height=i.bottom-i.top,i.x=i.left,i.y=i.top,i}(e),getDimensions:e=>{let{element:t}=e;return F(t)}},q=(e,t,n)=>(async(e,t,n)=>{const{placement:o="bottom",strategy:r="absolute",middleware:s=[],platform:l}=n;let c=await l.getElementRects({reference:e,floating:t,strategy:r}),{x:a,y:d}=i({...c,placement:o}),u=o,f={};for(let n=0;n<s.length;n++){const{name:h,fn:p}=s[n],{x:m,y:g,data:y,reset:w}=await p({x:a,y:d,initialPlacement:o,placement:u,strategy:r,middlewareData:f,rects:c,platform:l,elements:{reference:e,floating:t}});a=null!=m?m:a,d=null!=g?g:d,f={...f,[h]:null!=y?y:{}},w&&("object"==typeof w&&w.placement&&(u=w.placement),c=await l.getElementRects({reference:e,floating:t,strategy:r}),({x:a,y:d}=i({...c,placement:u})),n=-1)}return{x:a,y:d,placement:u,strategy:r,middlewareData:f}})(e,t,{platform:B,...n});const H=class{constructor(e,t,n,o,r){this.query=e,this.searchedTerms=t,this.queryParts=n,this.getNextN=o,this.free=r}};var J=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{c(o.next(e))}catch(e){s(e)}}function l(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}c((o=o.apply(e,t||[])).next())}))};const U=class{constructor(e,t,n){this.docId=e,this.score=t,this.fieldInfos=n,this.storage=Object.create(null)}populate(e,t,n){return J(this,void 0,void 0,(function*(){const{fieldStoreBlockSize:o,numStoresPerDir:r,indexingConfig:s}=n,{numDocsPerBlock:i}=s,l=Math.floor(this.docId/o),c=Math.floor(this.docId/i),a=Math.floor(l/r),d=`${e}field_store/${a}/${l}--${c}.json`;try{const e=yield t.fetch(d);let n=this.docId%o;i<o&&(n%=i),this.storage=e[n]}catch(e){console.log(e)}}))}getSingleField(e){const t=this.fieldInfos.find((t=>t.name===e));if(!t)return"";const n=this.storage.find((e=>e[0]===t.id));return n?n[1]:""}getStorageWithFieldNames(){return this.storage.map((e=>{const t=e.map((e=>e));return t[0]=this.fieldInfos[t[0]].name,t}))}};class z{constructor(){this.linkToJsons=Object.create(null)}fetch(e){return this.linkToJsons[e]||(this.linkToJsons[e]=fetch(e).then((e=>e.json()))),this.linkToJsons[e]}}var V=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{c(o.next(e))}catch(e){s(e)}}function l(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}c((o=o.apply(e,t||[])).next())}))};const X=class{constructor(t){this.options=t,this.isSetupDone=!1,this.workerQueryPromises=Object.create(null),this.nextId=0,this.worker=new Worker(new URL(e.p+e.u(658),e.b));const n=new Promise((e=>{this.worker.onmessage=t=>{if(t.data.isSetupDone)e();else if(t.data.query){const{query:e,queryId:n,nextResults:o,searchedTerms:r,queryParts:s}=t.data;this.workerQueryPromises[e][n].resolve({query:e,nextResults:o,searchedTerms:r,queryParts:s})}},this.worker.onmessageerror=e=>{console.log(e)}}));this.setupPromise=this.retrieveConfig().then((()=>{t.useQueryTermProximity=t.useQueryTermProximity&&this.morselsConfig.indexingConfig.withPositions,this.worker.postMessage(this.morselsConfig)})).then((()=>this.cacheFieldStores())).then((()=>n)).then((()=>this.isSetupDone=!0))}cacheFieldStores(){return V(this,void 0,void 0,(function*(){if(!this.options.cacheAllFieldStores)return;this.persistentJsonCache=new z;const e=[],t=Math.ceil(this.morselsConfig.lastDocId/this.morselsConfig.fieldStoreBlockSize),{numStoresPerDir:n,indexingConfig:o}=this.morselsConfig,{numDocsPerBlock:r}=o;for(let o=0;o<t;o++){const t=Math.floor(o/n),s=Math.min(this.morselsConfig.lastDocId,(o+1)*this.morselsConfig.fieldStoreBlockSize);for(let n=o*this.morselsConfig.fieldStoreBlockSize;n<s;n+=r){const s=Math.floor(n/r),i=`${this.options.url}field_store/${t}/${o}--${s}.json`;if(e.push([i,fetch(i).then((e=>e.json()))]),e.length>=10){const t=e.shift();this.persistentJsonCache.linkToJsons[t[0]]=yield t[1]}}}const s=yield Promise.all(e.map((e=>e[1])));e.forEach(((e,t)=>{this.persistentJsonCache.linkToJsons[e[0]]=s[t]}))}))}retrieveConfig(){return V(this,void 0,void 0,(function*(){const e=yield(yield fetch(`${this.options.url}morsels_config.json`,{method:"GET",headers:{"Content-Type":"application/json"}})).json();if("0.0.11"!==e.ver)throw new Error("Morsels search version not equal to indexer version!");"cacheAllFieldStores"in this.options||(this.options.cacheAllFieldStores=!!e.cache_all_field_stores);const{field_infos:t}=e,n=[];Object.entries(t.field_infos_map).forEach((([e,t])=>{t.name=e,n.push(t)})),n.sort(((e,t)=>e.id-t.id)),this.morselsConfig={lastDocId:e.last_doc_id,indexingConfig:{loaderConfigs:e.indexing_config.loader_configs,plNamesToCache:e.indexing_config.pl_names_to_cache,numDocsPerBlock:e.indexing_config.num_docs_per_block,numPlsPerDir:e.indexing_config.num_pls_per_dir,withPositions:e.indexing_config.with_positions},langConfig:e.lang_config,fieldInfos:n,numScoredFields:t.num_scored_fields,fieldStoreBlockSize:t.field_store_block_size,numStoresPerDir:t.num_stores_per_dir,searcherOptions:this.options}}))}deleteQuery(e,t){delete this.workerQueryPromises[e][t],0===Object.keys(this.workerQueryPromises[e]).length&&delete this.workerQueryPromises[e]}getQuery(e){return V(this,void 0,void 0,(function*(){yield this.setupPromise;const t=this.nextId;this.nextId+=1,this.workerQueryPromises[e]=this.workerQueryPromises[e]||{},this.workerQueryPromises[e][t]={promise:void 0,resolve:void 0},this.workerQueryPromises[e][t].promise=new Promise((n=>{this.workerQueryPromises[e][t].resolve=n,this.worker.postMessage({query:e,queryId:t})}));const n=yield this.workerQueryPromises[e][t].promise;return new H(e,n.searchedTerms,n.queryParts,(n=>V(this,void 0,void 0,(function*(){if(!this.workerQueryPromises[e]||!this.workerQueryPromises[e][t])return[];if(yield this.workerQueryPromises[e][t].promise,this.workerQueryPromises[e][t].promise=new Promise((o=>{this.workerQueryPromises[e][t].resolve=o,this.worker.postMessage({query:e,queryId:t,isGetNextN:!0,n})})),!this.workerQueryPromises[e]||!this.workerQueryPromises[e][t])return[];const o=(yield this.workerQueryPromises[e][t].promise).nextResults.map((([e,t])=>new U(e,t,this.morselsConfig.fieldInfos))),r=this.persistentJsonCache||new z;return yield Promise.all(o.map((e=>e.populate(this.options.url,r,this.morselsConfig)))),o}))),(()=>{this.deleteQuery(e,t),this.worker.postMessage({query:e,isFree:!0})}))}))}};function G(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function Y(e,t,...n){const o=document.createElement(e);return Object.entries(t).forEach((([e,t])=>{o.setAttribute(e,t)})),n.forEach((e=>{if("string"==typeof e){const t=document.createElement("span");t.textContent=e,o.appendChild(t)}else o.appendChild(e)})),o}const K=Y,Z="data-morsels-loading-indicator";function ee(){return Y("div",{[Z]:"true"})}function te(e){return e.startsWith("/")?new URL(new URL(window.location.href).origin+e):new URL(e)}var ne=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{c(o.next(e))}catch(e){s(e)}}function l(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}c((o=o.apply(e,t||[])).next())}))};const oe=new DOMParser,re="_relative_fp";function se(e,t){const n=t.map((t=>Array.from(e.matchAll(t))));if(!n.some((e=>e.length)))return{str:e,lastClosestTermLengths:[],lastClosestWindowPositions:[],numberTermsMatched:0};let o=t.map((()=>-1e8)),r=1e8,s=t.map((()=>0));const i=n.map((()=>0)),l=n.map((e=>!e.length)),c=n.map((()=>0)),a=n.map((()=>-1));for(;;){let e,t=1e10,d=1e10,u=0,f=!1,h=!0;for(let o=0;o<i.length;o++){const r=n[o][i[o]];if(!r)continue;const s=r[2];s.length>c[o]&&(f=!0,c[o]=s.length),h=h&&s.length===c[o];const p=r.index;!l[o]&&p<d&&(d=p,e=o),t=Math.min(t,p),u=Math.max(u,p),a[o]=p}const p=u-t;if((f||h&&p<r)&&(r=p,o=[...a],s=i.map(((e,t)=>n[t][e]&&n[t][e][0].length))),void 0===e)break;if(i[e]+=1,i[e]>=n[e].length&&(l[e]=!0,i[e]-=1,!l.some((e=>!e))))break}const d=o.map(((e,t)=>({pos:e,idx:t}))).filter((e=>e.pos>=0)).sort(((e,t)=>e.pos-t.pos)),u=d.length;return{str:e,lastClosestWindowPositions:d,lastClosestTermLengths:s,numberTermsMatched:u}}function ie(){return K("span",{class:"morsels-ellipsis","aria-label":"ellipses"}," ... ")}function le(e,t,n){const{highlightRender:o}=n.uiOptions.resultsRenderOpts,{str:r,lastClosestWindowPositions:s,lastClosestTermLengths:i}=e;if(!s.some((({pos:e})=>e>=0)))return t?[r.trimStart().substring(0,80),ie()]:[r];const l=[];let c=0;for(const{pos:e,idx:a}of s){const s=e+i[a];if(e>c+80)t&&l.push(ie()),l.push(r.substring(e-40,e)),l.push(o(K,n,r.substring(e,s)));else if(e>=c)l.pop(),l.push(r.substring(c,e)),l.push(o(K,n,r.substring(e,s)));else{if(!(s>c))continue;l.pop();l[l.length-1].textContent+=r.substring(c,s)}l.push(r.substring(s,s+40)),c=s}return t&&l.push(ie()),l}function ce(e,t,n,o){const{bodyOnlyRender:r,headingBodyRender:s}=o.uiOptions.resultsRenderOpts;let i,l={itemIdx:-100,fieldText:""},c=[];for(let n=0;n<e.length;n+=1){const[o,r]=e[n];if("headingLink"===o){l={itemIdx:n,fieldText:r};continue}const s=se(r,t);if("heading"===o)i=s,i.itemIdx=n,i.headingLink=l.itemIdx===i.itemIdx-1?l.fieldText:"",c.push({str:"",lastClosestTermLengths:[],lastClosestWindowPositions:[],numberTermsMatched:-2e3,headingMatch:i,headingLink:i.headingLink,itemIdx:n});else if("body"===o){const e=s;i?(e.headingMatch=i,e.headingLink=i.headingLink,e.numberTermsMatched+=i.numberTermsMatched):e.numberTermsMatched-=1e3,c.push(e)}}c.sort(((e,t)=>e.numberTermsMatched===t.numberTermsMatched&&0===e.numberTermsMatched?t.str.length-e.str.length:t.numberTermsMatched-e.numberTermsMatched));const a=[],d=Math.min(c.length,2);for(let e=0;e<d&&c[e].numberTermsMatched==c[0].numberTermsMatched;e+=1)a.push(c[e]);return a.map((e=>{const t=le(e,!0,o);if(e.headingMatch){const r=le(e.headingMatch,!1,o),i=r.length?r:[e.headingMatch.str],l=e.headingLink&&`${n}#${e.headingLink}`;return s(K,o,i,t,l)}return r(K,o,t)}))}const ae=new Set([re,"title","link"]);function de(e,t,n,o,r,s,i){return ne(this,void 0,void 0,(function*(){const{loaderConfigs:r}=n.indexingConfig,l=e.getStorageWithFieldNames();let c,a,d;for(const e of l){const[t,n]=e;switch(t){case"link":c=n;break;case re:a=n;break;case"title":d=n}if(c&&a&&d)break}const u="string"==typeof t.uiOptions.sourceFilesUrl,f=c||u&&a&&`${t.uiOptions.sourceFilesUrl}${a}`||"";d=d||a||c;let h,p=f;if(t.uiOptions.resultsRenderOpts.addSearchedTerms&&f){const e=te(f);e.searchParams.append(t.uiOptions.resultsRenderOpts.addSearchedTerms,s),p=e.toString()}if(o)h=ce(l.filter((e=>!ae.has(e[0]))),i,p,t);else if(f)if(f.endsWith(".html")&&r.HtmlLoader){const e=yield(yield fetch(f)).text(),n=oe.parseFromString(e,"text/html"),{title:o,bodies:s}=function(e,t,n,o,r){const s=[];if(t.exclude_selectors)for(const n of t.exclude_selectors){const t=e.querySelectorAll(n);for(let e=0;e<t.length;e+=1)t[e].remove()}t.selectors=t.selectors||[];const i=t.selectors.map((e=>e.selector)).join(",");!function e(n,o){for(const e of t.selectors)if(n.matches(e.selector)){Object.entries(e.attr_map).forEach((([e,t])=>{n.attributes[e]&&s.push([t,n.attributes[e].value])})),o=e.field_name;break}if(n.querySelector(i))for(let t=0;t<n.childNodes.length;t+=1){const r=n.childNodes[t];r.nodeType===Node.ELEMENT_NODE?e(r,o):r.nodeType===Node.TEXT_NODE&&o&&(s.length&&s[s.length-1][0]===o?s[s.length-1][1]+=r.data:s.push([o,r.data]))}else o&&(s.length&&s[s.length-1][0]===o?s[s.length-1][1]+=n.textContent:s.push([o,n.textContent||""]))}(e.documentElement,void 0);const l=s.find((e=>"title"===e[0]));let c="";return l&&([,c]=l,l[1]=""),{title:c,bodies:ce(s,n,o,r)}}(n,r.HtmlLoader,i,p,t);d=o||d,h=s}else if(f.endsWith(".txt")&&r.TxtLoader){h=ce([["body",yield(yield fetch(f)).text()]],i,p,t)}else{const e=te(f);if(e.pathname.endsWith(".json")&&r.JsonLoader){const n=yield(yield fetch(f)).json(),{title:o,bodies:s}=function(e,t,n,o,r){const s=[],{field_map:i,field_order:l}=t,c=Object.entries(i).find((([,e])=>"title"===e)),a=c&&c[0];for(const t of l)t!==a&&e[t]&&s.push([i[t],e[t]]);return{title:a&&e[a],bodies:ce(s,n,o,r)}}(e.hash?n[e.hash.substring(1)]:n,r.JsonLoader,i,p,t);d=o||d,h=s}}else h=[];return t.uiOptions.resultsRenderOpts.listItemRender(K,t,s,f,d,h,l)}))}function ue(e,t,n,o,r){const s=[],i=[];for(const e of r.searchedTerms){const t=e.map((e=>(i.push(e),`(${G(e)})`))).sort(((e,t)=>t.length-e.length)).join("|");if("ascii"===n.langConfig.lang){const e=new RegExp(`(^|\\W|_)(${t})(?=\\W|$)`,"gi");s.push(e)}else if("latin"===n.langConfig.lang){const e=new RegExp(`(^|\\W|_)(${t}\\W?)`,"gi");s.push(e)}else if("chinese"===n.langConfig.lang){const e=new RegExp(`()(${t})`,"gi");s.push(e)}}const l=n.fieldInfos.find((e=>e.do_store&&("body"===e.name||"title"===e.name||"heading"===e.name)));return Promise.all(o.map((e=>de(e,t,n,l,0,JSON.stringify(i),s))))}function fe(e,t,n,o,r,s,i){return ne(this,void 0,void 0,(function*(){if(t!==e.currQuery)return;const l=i.uiOptions.loadingIndicatorRender(K,i,!1,!1);o||r.appendChild(l),e.lastElObserver&&e.lastElObserver.disconnect();const c=document.createDocumentFragment();(o?i.uiOptions.termInfoRender(K,i,t.queryParts):[]).forEach((e=>c.appendChild(e)));const a=yield t.getNextN(i.uiOptions.resultsPerPage);if(t!==e.currQuery)return;const d=yield i.uiOptions.resultsRender(K,i,n,a,t);if(t!==e.currQuery)return;d.length?d.forEach((e=>c.appendChild(e))):o&&c.appendChild(i.uiOptions.noResultsRender(K,i));const u=c.lastElementChild;o?(r.innerHTML="",s.v=ee(),r.append(s.v),r.append(c)):l.replaceWith(c),d.length&&(e.lastElObserver=new IntersectionObserver(((o,l)=>ne(this,void 0,void 0,(function*(){o[0].isIntersecting&&(l.unobserve(u),yield fe(e,t,n,!1,r,s,i))}))),{rootMargin:"10px 10px 10px 10px"}),e.lastElObserver.observe(u))}))}var he;!function(e){e.Auto="auto",e.Dropdown="dropdown",e.Fullscreen="fullscreen",e.Target="target"}(he||(he={}));class pe{constructor(){this.isRunningNewQuery=!1}}var me=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{c(o.next(e))}catch(e){s(e)}}function l(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}c((o=o.apply(e,t||[])).next())}))};let ge=!1,ye=!1,we=!1;function be(e){return e.mode===he.Auto&&!ge||e.mode===he.Dropdown}function ve(e,t,n){e.setAttribute("role","combobox"),e.setAttribute("aria-expanded","true"),e.setAttribute("aria-owns",t.getAttribute("id")),t.setAttribute("role","listbox"),t.setAttribute("aria-label",n),t.setAttribute("aria-live","polite")}function xe(e,t){e.setAttribute("aria-autocomplete","list"),e.setAttribute("aria-controls",t),e.setAttribute("aria-activedescendant","morsels-list-selected")}function Re(e,t,n,o){const{uiOptions:r}=o;let s={v:ee()};const i=new pe;function l(l){var c;return me(this,void 0,void 0,(function*(){try{null===(c=i.currQuery)||void 0===c||c.free(),i.currQuery=yield n.getQuery(l),yield fe(i,i.currQuery,n.morselsConfig,!0,t,s,o),e.scrollTo({top:0}),t.scrollTo({top:0})}catch(e){throw console.error(e),t.innerHTML="",t.appendChild(r.errorRender(K,o)),e}finally{if(i.nextQuery){const e=i.nextQuery;i.nextQuery=void 0,yield e()}else i.isRunningNewQuery=!1}}))}let c=-1,a=!0;return d=>{const u=r.preprocessQuery(d.target.value);if(clearTimeout(c),u.length)c=setTimeout((()=>{if(a)t.innerHTML="",s.v=r.loadingIndicatorRender(K,o,!n.isSetupDone,!1),t.appendChild(s.v),n.isSetupDone||n.setupPromise.then((()=>{const e=r.loadingIndicatorRender(K,o,!n.isSetupDone,a);s.v.replaceWith(e),s.v=e})),be(r)&&r.showDropdown(e,t,o);else{const e=r.loadingIndicatorRender(K,o,!n.isSetupDone,!1);s.v.replaceWith(e),s.v=e}i.isRunningNewQuery?i.nextQuery=()=>l(u):(i.isRunningNewQuery=!0,l(u)),a=!1}),r.inputDebounce);else{const n=()=>{r.mode===he.Target?t.innerHTML="":be(r)?r.hideDropdown(e,t,o):(t.innerHTML="",t.appendChild(r.fsBlankRender(K,o))),i.isRunningNewQuery=!1,a=!0};i.isRunningNewQuery?i.nextQuery=n:n()}}}const Te=function(e){const t=e.isMobileDevice||(()=>window.matchMedia("only screen and (max-width: 1024px)").matches);ge=t(),function(e){if(e.searcherOptions=e.searcherOptions||{},!("url"in e.searcherOptions))throw new Error("Mandatory url parameter not specified");e.searcherOptions.url.endsWith("/")||(e.searcherOptions.url+="/"),"numberOfExpandedTerms"in e.searcherOptions||(e.searcherOptions.numberOfExpandedTerms=3),"useQueryTermProximity"in e.searcherOptions||(e.searcherOptions.useQueryTermProximity=!ge),"resultLimit"in e.searcherOptions||(e.searcherOptions.resultLimit=null),e.uiOptions=e.uiOptions||{};const{uiOptions:t}=e;if(t.sourceFilesUrl&&!t.sourceFilesUrl.endsWith("/")&&(t.sourceFilesUrl+="/"),t.mode=t.mode||he.Auto,t.mode===he.Target&&("string"==typeof t.target&&(t.target=document.getElementById(t.target)),!t.target))throw new Error("'target' mode specified but no valid target option specified");if("input"in t&&"string"!=typeof t.input||(t.input=document.getElementById(t.input||"morsels-search")),[he.Dropdown,he.Target].includes(t.mode)&&!t.input)throw new Error("'dropdown' or 'target' mode specified but no input element found");"inputDebounce"in t||(t.inputDebounce=100),t.preprocessQuery||(t.preprocessQuery=e=>e),"string"==typeof t.fsContainer&&(t.fsContainer=document.getElementById(t.fsContainer)),"dropdownAlignment"in t||(t.dropdownAlignment="bottom-end"),t.fsContainer||(t.fsContainer=document.getElementsByTagName("body")[0]),"resultsPerPage"in t||(t.resultsPerPage=8);const n=t.showDropdown||((e,n)=>{n.childElementCount&&(n.style.display="block",n.previousSibling.style.display="block",q(e,n,{placement:t.dropdownAlignment,middleware:[y(8),g({padding:10,mainAxis:!1}),w({apply({width:e,height:t}){Object.assign(n.style,{maxWidth:`min(${e}px, var(--morsels-dropdown-max-width))`,maxHeight:`min(${t}px, var(--morsels-dropdown-max-height))`})},padding:10})]}).then((({x:e,y:t})=>{Object.assign(n.style,{left:`${e}px`,top:`${t}px`})})))});t.showDropdown=(...e)=>{n(...e),ye=!0};const o=t.hideDropdown||((e,t)=>{t.style.display="none",t.previousSibling.style.display="none"});t.hideDropdown=(...e)=>{o(...e),ye=!1};const r=t.showFullscreen||((e,t,n)=>{n.appendChild(e);const o=e.querySelector("input.morsels-fs-input");o&&o.focus()});t.showFullscreen=(e,t,...n)=>{r(e,t,...n);const o=t.querySelector(".focus");o&&t.scrollTo({top:o.offsetTop-t.offsetTop-30}),we=!0};const s=t.hideFullscreen||(e=>{e.remove()});t.hideFullscreen=(...e)=>{s(...e),we=!1},t.label=t.label||"Search this site",t.fsPlaceholder=t.fsPlaceholder||"Search this site...",t.fsCloseText=t.fsCloseText||"Close",t.dropdownRootRender=t.dropdownRootRender||((e,n,o)=>{const r=e("div",{class:"morsels-root"},o);r.appendChild(e("div",{class:`morsels-input-dropdown-separator ${t.dropdownAlignment}`,style:"display: none;"})),xe(o,"morsels-dropdown-list");const s=e("ul",{id:"morsels-dropdown-list",class:"morsels-list",style:"display: none;"});return r.appendChild(s),ve(r,s,n.uiOptions.label),{dropdownRoot:r,dropdownListContainer:s}}),t.fsRootRender=t.fsRootRender||((e,n,o)=>{const r=e("div",{class:"morsels-root morsels-fs-root"});r.onclick=e=>e.stopPropagation(),r.onmousedown=e=>e.stopPropagation();const s=e("div",{class:"morsels-fs-backdrop"},r),i=e("label",{id:"morsels-fs-label",for:"morsels-fs-input",style:"display: none"},n.uiOptions.label),l=e("input",{class:"morsels-fs-input",type:"search",placeholder:n.uiOptions.fsPlaceholder,autocomplete:"false","aria-labelledby":"morsels-fs-label"});xe(l,"morsels-fs-list");const c=e("button",{class:"morsels-input-close-fs"},n.uiOptions.fsCloseText);c.onclick=e=>{e.preventDefault(),o()},r.appendChild(e("form",{class:"morsels-fs-input-button-wrapper"},i,l,c));const a=e("ul",{id:"morsels-fs-list",class:"morsels-list","aria-labelledby":"morsels-fs-label"});return r.appendChild(a),ve(r,a,n.uiOptions.label),s.addEventListener("mousedown",(()=>{t.hideFullscreen(s,a,r,n)})),s.addEventListener("keyup",(e=>{"Escape"===e.code&&(e.stopPropagation(),t.hideFullscreen(s,a,r,n))})),{root:s,listContainer:a,input:l}}),t.errorRender=t.errorRender||(e=>e("div",{class:"morsels-error"},"Oops! Something went wrong... 🙁")),t.noResultsRender=t.noResultsRender||(e=>e("div",{class:"morsels-no-results"},"No results found")),t.fsBlankRender=t.fsBlankRender||(e=>e("div",{class:"morsels-fs-blank"},"Start Searching Above!")),t.loadingIndicatorRender||(t.loadingIndicatorRender=(e,t,n,o)=>{const r=e("span",{class:"morsels-loading-indicator"});if(n){const t=e("div",{class:"morsels-initialising-text"},"... Initialising ...");return e("div",{class:"morsels-initialising"},t,r)}return o||r.classList.add("morsels-loading-indicator-subsequent"),r});const i=t.loadingIndicatorRender;t.loadingIndicatorRender=(...e)=>{const t=i(...e);return t.setAttribute(Z,"true"),t},t.termInfoRender=t.termInfoRender||(()=>[]),t.resultsRender=t.resultsRender||ue,t.resultsRenderOpts=t.resultsRenderOpts||{},t.resultsRenderOpts.listItemRender=t.resultsRenderOpts.listItemRender||((t,n,o,r,s,i)=>{const l=t("a",{class:"morsels-link"},t("div",{class:"morsels-title"},s),...i);if(r){let t=r;if(n.uiOptions.resultsRenderOpts.addSearchedTerms){const n=te(r);n.searchParams.append(e.uiOptions.resultsRenderOpts.addSearchedTerms,o),t=n.toString()}l.setAttribute("href",t)}return t("li",{class:"morsels-list-item",role:"option"},l)}),t.resultsRenderOpts.headingBodyRender=t.resultsRenderOpts.headingBodyRender||((e,t,n,o,r)=>{const s=e("a",{class:"morsels-heading-body"},e("div",{class:"morsels-heading"},...n),e("div",{class:"morsels-bodies"},e("div",{class:"morsels-body"},...o)));return r&&s.setAttribute("href",r),s}),t.resultsRenderOpts.bodyOnlyRender=t.resultsRenderOpts.bodyOnlyRender||((e,t,n)=>e("div",{class:"morsels-body"},...n)),t.resultsRenderOpts.highlightRender=t.resultsRenderOpts.highlightRender||((e,t,n)=>e("span",{class:"morsels-highlight"},n)),e.otherOptions=e.otherOptions||{}}(e);const{uiOptions:n}=e,o=new X(e.searcherOptions),{root:r,listContainer:s,input:i}=n.fsRootRender(K,e,(()=>n.hideFullscreen(r,s,n.fsContainer,e)));let l;i.addEventListener("input",Re(r,s,o,e)),s.appendChild(n.fsBlankRender(K,e));const{input:c}=n;if(!c||n.mode!==he.Auto&&n.mode!==he.Dropdown){if(c&&n.mode===he.Fullscreen)c.addEventListener("focus",(()=>{n.showFullscreen(r,s,n.fsContainer,e)}));else if(c&&n.mode===he.Target){c.addEventListener("input",Re(n.target,n.target,o,e));let t=n.target.getAttribute("id");t||(n.target.setAttribute("id","morsels-target-list"),t="morsels-target-list"),xe(c,t),ve(c,n.target,n.label)}}else{const i=c.parentElement;c.remove();const{dropdownRoot:a,dropdownListContainer:d}=n.dropdownRootRender(K,e,c);function u(){n.hideDropdown(a,l,e),document.activeElement===c&&n.showDropdown(a,l,e)}let f;l=d,i.appendChild(a),c.addEventListener("input",Re(a,l,o,e)),window.addEventListener("resize",(()=>{clearTimeout(f),f=setTimeout((()=>{n.mode!==he.Dropdown?(ge=t(),ge?n.hideDropdown(a,l,e):(n.hideFullscreen(r,s,n.fsContainer,e),u())):u()}),10)})),c.addEventListener("blur",(()=>{be(n)&&setTimeout((()=>{let t=document.activeElement;for(;t;)if(t=t.parentElement,t===a)return void c.focus();n.hideDropdown(a,l,e)}),100)})),c.addEventListener("focus",(()=>{be(n)?n.showDropdown(a,l,e):n.showFullscreen(r,s,n.fsContainer,e)}))}function a(e){if(!["ArrowDown","ArrowUp","Home","End","Enter"].includes(e.key))return;let t,o=e=>{t.scrollTo({top:e.offsetTop-t.offsetTop-30})};if(be(n)){if(!ye)return;t=l}else if(n.mode===he.Target)t=n.target,o=e=>{e.scrollIntoView({block:"center"})};else{if(!we)return;t=s}const r=t.querySelector(".focus");function i(e){r&&(r.classList.remove("focus"),r.removeAttribute("aria-selected"),r.removeAttribute("id")),e.classList.add("focus"),e.setAttribute("aria-selected","true"),e.setAttribute("id","morsels-list-selected"),o(e)}function c(e,t){e&&!e.getAttribute(Z)?i(e):t&&!t.getAttribute(Z)&&i(t)}const a=t.firstElementChild,d=t.lastElementChild;if("ArrowDown"===e.key)r?c(r.nextElementSibling,null):c(a,null==a?void 0:a.nextElementSibling);else if("ArrowUp"===e.key)r&&c(r.previousElementSibling,null);else if("Home"===e.key)c(a,null==a?void 0:a.nextElementSibling);else if("End"===e.key)c(d,null==d?void 0:d.previousElementSibling);else if("Enter"===e.key&&r){const e=r.querySelector("a[href]");e&&(window.location.href=e.getAttribute("href"))}e.preventDefault()}return null==c||c.addEventListener("keydown",a),i.addEventListener("keydown",a),{showFullscreen:()=>{n.showFullscreen(r,s,n.fsContainer,e)},hideFullscreen:()=>{n.hideFullscreen(r,s,n.fsContainer,e)}}};return t=t.default})()}));