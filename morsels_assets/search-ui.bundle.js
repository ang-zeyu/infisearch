!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.initMorsels=t():e.initMorsels=t()}(self,(function(){return(()=>{"use strict";var e={m:{},d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},u:e=>"search.worker.bundle.js"};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var o=n.getElementsByTagName("script");o.length&&(t=o[o.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})(),e.b=document.baseURI||self.location.href;var t={};function n(e){return e.split("-")[0]}function o(e){return e.split("-")[1]}function s(e){return["top","bottom"].includes(n(e))?"x":"y"}function r(e){return"y"===e?"height":"width"}function i(e,t,i){let{reference:l,floating:a}=e;const c=l.x+l.width/2-a.width/2,d=l.y+l.height/2-a.height/2,u=s(t),f=r(u),h=l[f]/2-a[f]/2,p="x"===u;let m;switch(n(t)){case"top":m={x:c,y:l.y-a.height};break;case"bottom":m={x:c,y:l.y+l.height};break;case"right":m={x:l.x+l.width,y:d};break;case"left":m={x:l.x-a.width,y:d};break;default:m={x:l.x,y:l.y}}switch(o(t)){case"start":m[u]-=h*(i&&p?-1:1);break;case"end":m[u]+=h*(i&&p?-1:1)}return m}e.d(t,{default:()=>Ae});function l(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}function a(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}async function c(e,t){var n;void 0===t&&(t={});const{x:o,y:s,platform:r,rects:i,elements:c,strategy:d}=e,{boundary:u="clippingAncestors",rootBoundary:f="viewport",elementContext:h="floating",altBoundary:p=!1,padding:m=0}=t,g=l(m),y=c[p?"floating"===h?"reference":"floating":h],w=a(await r.getClippingRect({element:null==(n=await(null==r.isElement?void 0:r.isElement(y)))||n?y:y.contextElement||await(null==r.getDocumentElement?void 0:r.getDocumentElement(c.floating)),boundary:u,rootBoundary:f,strategy:d})),b=a(r.convertOffsetParentRelativeRectToViewportRelativeRect?await r.convertOffsetParentRelativeRectToViewportRelativeRect({rect:"floating"===h?{...i.floating,x:o,y:s}:i.reference,offsetParent:await(null==r.getOffsetParent?void 0:r.getOffsetParent(c.floating)),strategy:d}):i[h]);return{top:w.top-b.top+g.top,bottom:b.bottom-w.bottom+g.bottom,left:w.left-b.left+g.left,right:b.right-w.right+g.right}}const d=Math.min,u=Math.max;function f(e,t,n){return u(e,d(t,n))}const h=e=>({name:"arrow",options:e,async fn(t){const{element:n,padding:o=0}=null!=e?e:{},{x:i,y:a,placement:c,rects:d,platform:u}=t;if(null==n)return{};const h=l(o),p={x:i,y:a},m=s(c),g=r(m),y=await u.getDimensions(n),w="y"===m?"top":"left",b="y"===m?"bottom":"right",v=d.reference[g]+d.reference[m]-p[m]-d.floating[g],x=p[m]-d.reference[m],R=await(null==u.getOffsetParent?void 0:u.getOffsetParent(n));let T=R?"y"===m?R.clientHeight||0:R.clientWidth||0:0;0===T&&(T=d.floating[g]);const O=v/2-x/2,C=h[w],k=T-y[g]-h[b],P=T/2-y[g]/2+O,E=f(C,P,k);return{data:{[m]:E,centerOffset:P-E}}}}),p={left:"right",right:"left",bottom:"top",top:"bottom"};function m(e){return e.replace(/left|right|bottom|top/g,(e=>p[e]))}function g(e,t,n){void 0===n&&(n=!1);const i=o(e),l=s(e),a=r(l);let c="x"===l?i===(n?"end":"start")?"right":"left":"start"===i?"bottom":"top";return t.reference[a]>t.floating[a]&&(c=m(c)),{main:c,cross:m(c)}}const y={start:"end",end:"start"};function w(e){return e.replace(/start|end/g,(e=>y[e]))}const b=["top","right","bottom","left"],v=(b.reduce(((e,t)=>e.concat(t,t+"-start",t+"-end")),[]),function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var o;const{placement:s,middlewareData:r,rects:i,initialPlacement:l,platform:a,elements:d}=t,{mainAxis:u=!0,crossAxis:f=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",flipAlignment:y=!0,...b}=e,v=n(s),x=h||(v!==l&&y?function(e){const t=m(e);return[w(e),t,w(t)]}(l):[m(l)]),R=[l,...x],T=await c(t,b),O=[];let C=(null==(o=r.flip)?void 0:o.overflows)||[];if(u&&O.push(T[v]),f){const{main:e,cross:t}=g(s,i,await(null==a.isRTL?void 0:a.isRTL(d.floating)));O.push(T[e],T[t])}if(C=[...C,{placement:s,overflows:O}],!O.every((e=>e<=0))){var k,P;const e=(null!=(k=null==(P=r.flip)?void 0:P.index)?k:0)+1,t=R[e];if(t)return{data:{index:e,overflows:C},reset:{placement:t}};let n="bottom";switch(p){case"bestFit":{var E;const e=null==(E=C.map((e=>[e,e.overflows.filter((e=>e>0)).reduce(((e,t)=>e+t),0)])).sort(((e,t)=>e[1]-t[1]))[0])?void 0:E[0].placement;e&&(n=e);break}case"initialPlacement":n=l}if(s!==n)return{reset:{placement:n}}}return{}}}});const x=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){const{placement:s,rects:r,platform:i,elements:l}=t,{apply:a,...d}=e,f=await c(t,d),h=n(s),p=o(s);let m,g;"top"===h||"bottom"===h?(m=h,g=p===(await(null==i.isRTL?void 0:i.isRTL(l.floating))?"start":"end")?"left":"right"):(g=h,m="end"===p?"top":"bottom");const y=u(f.left,0),w=u(f.right,0),b=u(f.top,0),v=u(f.bottom,0),x={availableHeight:r.floating.height-(["left","right"].includes(s)?2*(0!==b||0!==v?b+v:u(f.top,f.bottom)):f[m]),availableWidth:r.floating.width-(["top","bottom"].includes(s)?2*(0!==y||0!==w?y+w:u(f.left,f.right)):f[g])},R=await i.getDimensions(l.floating);null==a||a({...t,...x});const T=await i.getDimensions(l.floating);return R.width!==T.width||R.height!==T.height?{reset:{rects:!0}}:{}}}};function R(e){return e&&e.document&&e.location&&e.alert&&e.setInterval}function T(e){if(null==e)return window;if(!R(e)){const t=e.ownerDocument;return t&&t.defaultView||window}return e}function O(e){return T(e).getComputedStyle(e)}function C(e){return R(e)?"":e?(e.nodeName||"").toLowerCase():""}function k(){const e=navigator.userAgentData;return null!=e&&e.brands?e.brands.map((e=>e.brand+"/"+e.version)).join(" "):navigator.userAgent}function P(e){return e instanceof T(e).HTMLElement}function E(e){return e instanceof T(e).Element}function L(e){return"undefined"!=typeof ShadowRoot&&(e instanceof T(e).ShadowRoot||e instanceof ShadowRoot)}function S(e){const{overflow:t,overflowX:n,overflowY:o}=O(e);return/auto|scroll|overlay|hidden/.test(t+o+n)}function A(e){return["table","td","th"].includes(C(e))}function D(e){const t=/firefox/i.test(k()),n=O(e);return"none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||["transform","perspective"].includes(n.willChange)||t&&"filter"===n.willChange||t&&!!n.filter&&"none"!==n.filter}function M(){return!/^((?!chrome|android).)*safari/i.test(k())}const _=Math.min,I=Math.max,Q=Math.round;function F(e,t,n){var o,s,r,i;void 0===t&&(t=!1),void 0===n&&(n=!1);const l=e.getBoundingClientRect();let a=1,c=1;t&&P(e)&&(a=e.offsetWidth>0&&Q(l.width)/e.offsetWidth||1,c=e.offsetHeight>0&&Q(l.height)/e.offsetHeight||1);const d=E(e)?T(e):window,u=!M()&&n,f=(l.left+(u&&null!=(o=null==(s=d.visualViewport)?void 0:s.offsetLeft)?o:0))/a,h=(l.top+(u&&null!=(r=null==(i=d.visualViewport)?void 0:i.offsetTop)?r:0))/c,p=l.width/a,m=l.height/c;return{width:p,height:m,top:h,right:f+p,bottom:h+m,left:f,x:f,y:h}}function W(e){return(t=e,(t instanceof T(t).Node?e.ownerDocument:e.document)||window.document).documentElement;var t}function j(e){return E(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function B(e){return F(W(e)).left+j(e).scrollLeft}function $(e,t,n){const o=P(t),s=W(t),r=F(e,o&&function(e){const t=F(e);return Q(t.width)!==e.offsetWidth||Q(t.height)!==e.offsetHeight}(t),"fixed"===n);let i={scrollLeft:0,scrollTop:0};const l={x:0,y:0};if(o||!o&&"fixed"!==n)if(("body"!==C(t)||S(s))&&(i=j(t)),P(t)){const e=F(t,!0);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else s&&(l.x=B(s));return{x:r.left+i.scrollLeft-l.x,y:r.top+i.scrollTop-l.y,width:r.width,height:r.height}}function N(e){return"html"===C(e)?e:e.assignedSlot||e.parentNode||(L(e)?e.host:null)||W(e)}function H(e){return P(e)&&"fixed"!==getComputedStyle(e).position?e.offsetParent:null}function q(e){const t=T(e);let n=H(e);for(;n&&A(n)&&"static"===getComputedStyle(n).position;)n=H(n);return n&&("html"===C(n)||"body"===C(n)&&"static"===getComputedStyle(n).position&&!D(n))?t:n||function(e){let t=N(e);for(L(t)&&(t=t.host);P(t)&&!["html","body"].includes(C(t));){if(D(t))return t;t=t.parentNode}return null}(e)||t}function J(e){if(P(e))return{width:e.offsetWidth,height:e.offsetHeight};const t=F(e);return{width:t.width,height:t.height}}function U(e){const t=N(e);return["html","body","#document"].includes(C(t))?e.ownerDocument.body:P(t)&&S(t)?t:U(t)}function V(e,t){var n;void 0===t&&(t=[]);const o=U(e),s=o===(null==(n=e.ownerDocument)?void 0:n.body),r=T(o),i=s?[r].concat(r.visualViewport||[],S(o)?o:[]):o,l=t.concat(i);return s?l:l.concat(V(i))}function z(e,t,n){return"viewport"===t?a(function(e,t){const n=T(e),o=W(e),s=n.visualViewport;let r=o.clientWidth,i=o.clientHeight,l=0,a=0;if(s){r=s.width,i=s.height;const e=M();(e||!e&&"fixed"===t)&&(l=s.offsetLeft,a=s.offsetTop)}return{width:r,height:i,x:l,y:a}}(e,n)):E(t)?function(e,t){const n=F(e,!1,"fixed"===t),o=n.top+e.clientTop,s=n.left+e.clientLeft;return{top:o,left:s,x:s,y:o,right:s+e.clientWidth,bottom:o+e.clientHeight,width:e.clientWidth,height:e.clientHeight}}(t,n):a(function(e){var t;const n=W(e),o=j(e),s=null==(t=e.ownerDocument)?void 0:t.body,r=I(n.scrollWidth,n.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),i=I(n.scrollHeight,n.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0);let l=-o.scrollLeft+B(e);const a=-o.scrollTop;return"rtl"===O(s||n).direction&&(l+=I(n.clientWidth,s?s.clientWidth:0)-r),{width:r,height:i,x:l,y:a}}(W(e)))}function X(e){const t=V(e),n=["absolute","fixed"].includes(O(e).position)&&P(e)?q(e):e;return E(n)?t.filter((e=>E(e)&&function(e,t){const n=null==t||null==t.getRootNode?void 0:t.getRootNode();if(null!=e&&e.contains(t))return!0;if(n&&L(n)){let n=t;do{if(n&&e===n)return!0;n=n.parentNode||n.host}while(n)}return!1}(e,n)&&"body"!==C(e))):[]}const G={getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:o,strategy:s}=e;const r=[..."clippingAncestors"===n?X(t):[].concat(n),o],i=r[0],l=r.reduce(((e,n)=>{const o=z(t,n,s);return e.top=I(o.top,e.top),e.right=_(o.right,e.right),e.bottom=_(o.bottom,e.bottom),e.left=I(o.left,e.left),e}),z(t,i,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:t,offsetParent:n,strategy:o}=e;const s=P(n),r=W(n);if(n===r)return t;let i={scrollLeft:0,scrollTop:0};const l={x:0,y:0};if((s||!s&&"fixed"!==o)&&(("body"!==C(n)||S(r))&&(i=j(n)),P(n))){const e=F(n,!0);l.x=e.x+n.clientLeft,l.y=e.y+n.clientTop}return{...t,x:t.x-i.scrollLeft+l.x,y:t.y-i.scrollTop+l.y}},isElement:E,getDimensions:J,getOffsetParent:q,getDocumentElement:W,getElementRects:e=>{let{reference:t,floating:n,strategy:o}=e;return{reference:$(t,q(n),o),floating:{...J(n),x:0,y:0}}},getClientRects:e=>Array.from(e.getClientRects()),isRTL:e=>"rtl"===O(e).direction};const Y=(e,t,n)=>(async(e,t,n)=>{const{placement:o="bottom",strategy:s="absolute",middleware:r=[],platform:l}=n,a=await(null==l.isRTL?void 0:l.isRTL(t));let c=await l.getElementRects({reference:e,floating:t,strategy:s}),{x:d,y:u}=i(c,o,a),f=o,h={};for(let n=0;n<r.length;n++){const{name:p,fn:m}=r[n],{x:g,y,data:w,reset:b}=await m({x:d,y:u,initialPlacement:o,placement:f,strategy:s,middlewareData:h,rects:c,platform:l,elements:{reference:e,floating:t}});d=null!=g?g:d,u=null!=y?y:u,h={...h,[p]:{...h[p],...w}},b&&("object"==typeof b&&(b.placement&&(f=b.placement),b.rects&&(c=!0===b.rects?await l.getElementRects({reference:e,floating:t,strategy:s}):b.rects),({x:d,y:u}=i(c,f,a))),n=-1)}return{x:d,y:u,placement:f,strategy:s,middlewareData:h}})(e,t,{platform:G,...n});const K=class{constructor(e,t,n,o,s){this.query=e,this.searchedTerms=t,this.queryParts=n,this.getNextN=o,this.free=s}};var Z=function(e,t,n,o){return new(n||(n=Promise))((function(s,r){function i(e){try{a(o.next(e))}catch(e){r(e)}}function l(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}a((o=o.apply(e,t||[])).next())}))};const ee=class{constructor(e,t,n){this.docId=e,this.score=t,this.fieldInfos=n,this.storage=Object.create(null)}populate(e,t,n){return Z(this,void 0,void 0,(function*(){const{fieldStoreBlockSize:o,numStoresPerDir:s,indexingConfig:r}=n,{numDocsPerBlock:i}=r,l=Math.floor(this.docId/o),a=Math.floor(this.docId/i),c=Math.floor(l/s),d=`${e}field_store/${c}/${l}--${a}.json`;try{const e=yield t.fetch(d);let n=this.docId%o;i<o&&(n%=i),this.storage=e[n]}catch(e){console.log(e)}}))}getSingleField(e){const t=this.fieldInfos.find((t=>t.name===e));if(!t)return"";const n=this.storage.find((e=>e[0]===t.id));return n?n[1]:""}getStorageWithFieldNames(){return this.storage.map((e=>{const t=e.map((e=>e));return t[0]=this.fieldInfos[t[0]].name,t}))}};class te{constructor(){this.linkToJsons=Object.create(null)}fetch(e){return this.linkToJsons[e]||(this.linkToJsons[e]=fetch(e).then((e=>e.json()))),this.linkToJsons[e]}}var ne=function(e,t,n,o){return new(n||(n=Promise))((function(s,r){function i(e){try{a(o.next(e))}catch(e){r(e)}}function l(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}a((o=o.apply(e,t||[])).next())}))};const oe=class{constructor(t){this.options=t,this.isSetupDone=!1,this.workerQueryPromises=Object.create(null),this.nextId=0,this.worker=new Worker(new URL(e.p+e.u(658),e.b));const n=new Promise((e=>{this.worker.onmessage=t=>{if(t.data.isSetupDone)e();else if(t.data.query){const{query:e,queryId:n,nextResults:o,searchedTerms:s,queryParts:r}=t.data;this.workerQueryPromises[e][n].resolve({query:e,nextResults:o,searchedTerms:s,queryParts:r})}},this.worker.onmessageerror=e=>{console.log(e)}}));this.setupPromise=this.retrieveConfig().then((()=>{t.useQueryTermProximity=t.useQueryTermProximity&&this.morselsConfig.indexingConfig.withPositions,this.worker.postMessage(this.morselsConfig)})).then((()=>this.cacheFieldStores())).then((()=>n)).then((()=>this.isSetupDone=!0))}cacheFieldStores(){return ne(this,void 0,void 0,(function*(){if(!this.options.cacheAllFieldStores)return;this.persistentJsonCache=new te;const e=[],t=Math.ceil(this.morselsConfig.lastDocId/this.morselsConfig.fieldStoreBlockSize),{numStoresPerDir:n,indexingConfig:o}=this.morselsConfig,{numDocsPerBlock:s}=o;for(let o=0;o<t;o++){const t=Math.floor(o/n),r=Math.min(this.morselsConfig.lastDocId,(o+1)*this.morselsConfig.fieldStoreBlockSize);for(let n=o*this.morselsConfig.fieldStoreBlockSize;n<r;n+=s){const r=Math.floor(n/s),i=`${this.options.url}field_store/${t}/${o}--${r}.json`;if(e.push([i,fetch(i).then((e=>e.json()))]),e.length>=10){const t=e.shift();this.persistentJsonCache.linkToJsons[t[0]]=yield t[1]}}}const r=yield Promise.all(e.map((e=>e[1])));e.forEach(((e,t)=>{this.persistentJsonCache.linkToJsons[e[0]]=r[t]}))}))}retrieveConfig(){return ne(this,void 0,void 0,(function*(){const e=yield(yield fetch(`${this.options.url}morsels_config.json`,{method:"GET",headers:{"Content-Type":"application/json"}})).json();if("0.0.11"!==e.ver)throw new Error("Morsels search version not equal to indexer version!");"cacheAllFieldStores"in this.options||(this.options.cacheAllFieldStores=!!e.cache_all_field_stores);const{field_infos:t}=e,n=[];Object.entries(t.field_infos_map).forEach((([e,t])=>{t.name=e,n.push(t)})),n.sort(((e,t)=>e.id-t.id)),this.morselsConfig={lastDocId:e.last_doc_id,indexingConfig:{loaderConfigs:e.indexing_config.loader_configs,plNamesToCache:e.indexing_config.pl_names_to_cache,numDocsPerBlock:e.indexing_config.num_docs_per_block,numPlsPerDir:e.indexing_config.num_pls_per_dir,withPositions:e.indexing_config.with_positions},langConfig:e.lang_config,fieldInfos:n,numScoredFields:t.num_scored_fields,fieldStoreBlockSize:t.field_store_block_size,numStoresPerDir:t.num_stores_per_dir,searcherOptions:this.options}}))}deleteQuery(e,t){delete this.workerQueryPromises[e][t],0===Object.keys(this.workerQueryPromises[e]).length&&delete this.workerQueryPromises[e]}getQuery(e){return ne(this,void 0,void 0,(function*(){yield this.setupPromise;const t=this.nextId;this.nextId+=1,this.workerQueryPromises[e]=this.workerQueryPromises[e]||{},this.workerQueryPromises[e][t]={promise:void 0,resolve:void 0},this.workerQueryPromises[e][t].promise=new Promise((n=>{this.workerQueryPromises[e][t].resolve=n,this.worker.postMessage({query:e,queryId:t})}));const n=yield this.workerQueryPromises[e][t].promise;return new K(e,n.searchedTerms,n.queryParts,(n=>ne(this,void 0,void 0,(function*(){if(!this.workerQueryPromises[e]||!this.workerQueryPromises[e][t])return[];if(yield this.workerQueryPromises[e][t].promise,this.workerQueryPromises[e][t].promise=new Promise((o=>{this.workerQueryPromises[e][t].resolve=o,this.worker.postMessage({query:e,queryId:t,isGetNextN:!0,n})})),!this.workerQueryPromises[e]||!this.workerQueryPromises[e][t])return[];const o=(yield this.workerQueryPromises[e][t].promise).nextResults.map((([e,t])=>new ee(e,t,this.morselsConfig.fieldInfos))),s=this.persistentJsonCache||new te;return yield Promise.all(o.map((e=>e.populate(this.options.url,s,this.morselsConfig)))),o}))),(()=>{this.deleteQuery(e,t),this.worker.postMessage({query:e,isFree:!0})}))}))}};function se(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function re(e,t,...n){const o=document.createElement(e);return Object.entries(t).forEach((([e,t])=>{o.setAttribute(e,t)})),n.forEach((e=>{if("string"==typeof e){const t=document.createElement("span");t.textContent=e,o.appendChild(t)}else o.appendChild(e)})),o}const ie=re,le="data-morsels-loading-indicator";function ae(){return re("div",{[le]:"true"})}function ce(e){return e.startsWith("/")?new URL(new URL(window.location.href).origin+e):new URL(e)}var de=function(e,t,n,o){return new(n||(n=Promise))((function(s,r){function i(e){try{a(o.next(e))}catch(e){r(e)}}function l(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}a((o=o.apply(e,t||[])).next())}))};const ue=new DOMParser,fe="_relative_fp";function he(e,t){const n=t.map((t=>Array.from(e.matchAll(t))));if(!n.some((e=>e.length)))return{str:e,lastClosestTermLengths:[],lastClosestWindowPositions:[],numberTermsMatched:0};let o=t.map((()=>-1e8)),s=1e8,r=t.map((()=>0));const i=n.map((()=>0)),l=n.map((e=>!e.length)),a=n.map((()=>0)),c=n.map((()=>-1));for(;;){let e,t=1e10,d=1e10,u=0,f=!1,h=!0;for(let o=0;o<i.length;o++){const s=n[o][i[o]];if(!s)continue;const r=s[2];r.length>a[o]&&(f=!0,a[o]=r.length),h=h&&r.length===a[o];const p=s.index;!l[o]&&p<d&&(d=p,e=o),t=Math.min(t,p),u=Math.max(u,p),c[o]=p}const p=u-t;if((f||h&&p<s)&&(s=p,o=[...c],r=i.map(((e,t)=>n[t][e]&&n[t][e][0].length))),void 0===e)break;if(i[e]+=1,i[e]>=n[e].length&&(l[e]=!0,i[e]-=1,!l.some((e=>!e))))break}const d=o.map(((e,t)=>({pos:e,idx:t}))).filter((e=>e.pos>=0)).sort(((e,t)=>e.pos-t.pos)),u=d.length;return{str:e,lastClosestWindowPositions:d,lastClosestTermLengths:r,numberTermsMatched:u}}function pe(){return ie("span",{class:"morsels-ellipsis","aria-label":"ellipses"}," ... ")}function me(e,t,n){const{highlightRender:o}=n.uiOptions.resultsRenderOpts,{str:s,lastClosestWindowPositions:r,lastClosestTermLengths:i}=e;if(!r.some((({pos:e})=>e>=0)))return t?[s.trimStart().substring(0,80),pe()]:[s];const l=[];let a=0;for(const{pos:e,idx:c}of r){const r=e+i[c];if(e>a+80)t&&l.push(pe()),l.push(s.substring(e-40,e)),l.push(o(ie,n,s.substring(e,r)));else if(e>=a)l.pop(),l.push(s.substring(a,e)),l.push(o(ie,n,s.substring(e,r)));else{if(!(r>a))continue;l.pop();l[l.length-1].textContent+=s.substring(a,r)}l.push(s.substring(r,r+40)),a=r}return t&&l.push(pe()),l}function ge(e,t,n,o){const{bodyOnlyRender:s,headingBodyRender:r}=o.uiOptions.resultsRenderOpts;let i,l={itemIdx:-100,fieldText:""},a=[];for(let n=0;n<e.length;n+=1){const[o,s]=e[n];if("headingLink"===o){l={itemIdx:n,fieldText:s};continue}const r=he(s,t);if("heading"===o)i=r,i.itemIdx=n,i.headingLink=l.itemIdx===i.itemIdx-1?l.fieldText:"",a.push({str:"",lastClosestTermLengths:[],lastClosestWindowPositions:[],numberTermsMatched:-2e3,headingMatch:i,headingLink:i.headingLink,itemIdx:n});else if("body"===o){const e=r;i?(e.headingMatch=i,e.headingLink=i.headingLink,e.numberTermsMatched+=i.numberTermsMatched):e.numberTermsMatched-=1e3,a.push(e)}}a.sort(((e,t)=>e.numberTermsMatched===t.numberTermsMatched&&0===e.numberTermsMatched?t.str.length-e.str.length:t.numberTermsMatched-e.numberTermsMatched));const c=[],d=Math.min(a.length,2);for(let e=0;e<d&&a[e].numberTermsMatched==a[0].numberTermsMatched;e+=1)c.push(a[e]);return c.map((e=>{const t=me(e,!0,o);if(e.headingMatch){const s=me(e.headingMatch,!1,o),i=s.length?s:[e.headingMatch.str],l=e.headingLink&&`${n}#${e.headingLink}`;return r(ie,o,i,t,l)}return s(ie,o,t)}))}const ye=new Set([fe,"title","link"]);function we(e,t,n,o,s,r,i){return de(this,void 0,void 0,(function*(){const{loaderConfigs:s}=n.indexingConfig,l=e.getStorageWithFieldNames();let a,c,d;for(const e of l){const[t,n]=e;switch(t){case"link":a=n;break;case fe:c=n;break;case"title":d=n}if(a&&c&&d)break}const u="string"==typeof t.uiOptions.sourceFilesUrl,f=a||u&&c&&`${t.uiOptions.sourceFilesUrl}${c}`||"";d=d||c||a;let h,p=f;if(t.uiOptions.resultsRenderOpts.addSearchedTerms&&f){const e=ce(f);e.searchParams.append(t.uiOptions.resultsRenderOpts.addSearchedTerms,r),p=e.toString()}if(o)h=ge(l.filter((e=>!ye.has(e[0]))),i,p,t);else if(f)if(f.endsWith(".html")&&s.HtmlLoader){const e=yield(yield fetch(f)).text(),n=ue.parseFromString(e,"text/html"),{title:o,bodies:r}=function(e,t,n,o,s){const r=[];if(t.exclude_selectors)for(const n of t.exclude_selectors){const t=e.querySelectorAll(n);for(let e=0;e<t.length;e+=1)t[e].remove()}t.selectors=t.selectors||[];const i=t.selectors.map((e=>e.selector)).join(",");!function e(n,o){for(const e of t.selectors)if(n.matches(e.selector)){Object.entries(e.attr_map).forEach((([e,t])=>{n.attributes[e]&&r.push([t,n.attributes[e].value])})),o=e.field_name;break}if(n.querySelector(i))for(let t=0;t<n.childNodes.length;t+=1){const s=n.childNodes[t];s.nodeType===Node.ELEMENT_NODE?e(s,o):s.nodeType===Node.TEXT_NODE&&o&&(r.length&&r[r.length-1][0]===o?r[r.length-1][1]+=s.data:r.push([o,s.data]))}else o&&(r.length&&r[r.length-1][0]===o?r[r.length-1][1]+=n.textContent:r.push([o,n.textContent||""]))}(e.documentElement,void 0);const l=r.find((e=>"title"===e[0]));let a="";return l&&([,a]=l,l[1]=""),{title:a,bodies:ge(r,n,o,s)}}(n,s.HtmlLoader,i,p,t);d=o||d,h=r}else if(f.endsWith(".txt")&&s.TxtLoader){h=ge([["body",yield(yield fetch(f)).text()]],i,p,t)}else{const e=ce(f);if(e.pathname.endsWith(".json")&&s.JsonLoader){const n=yield(yield fetch(f)).json(),{title:o,bodies:r}=function(e,t,n,o,s){const r=[],{field_map:i,field_order:l}=t,a=Object.entries(i).find((([,e])=>"title"===e)),c=a&&a[0];for(const t of l)t!==c&&e[t]&&r.push([i[t],e[t]]);return{title:c&&e[c],bodies:ge(r,n,o,s)}}(e.hash?n[e.hash.substring(1)]:n,s.JsonLoader,i,p,t);d=o||d,h=r}}else h=[];return t.uiOptions.resultsRenderOpts.listItemRender(ie,t,r,f,d,h,l)}))}function be(e,t,n,o,s){const r=[],i=[];for(const e of s.searchedTerms){const t=e.map((e=>(i.push(e),`(${se(e)})`))).sort(((e,t)=>t.length-e.length)).join("|");if("ascii"===n.langConfig.lang){const e=new RegExp(`(^|\\W|_)(${t})(?=\\W|$)`,"gi");r.push(e)}else if("latin"===n.langConfig.lang){const e=new RegExp(`(^|\\W|_)(${t}\\W?)`,"gi");r.push(e)}else if("chinese"===n.langConfig.lang){const e=new RegExp(`()(${t})`,"gi");r.push(e)}}const l=n.fieldInfos.find((e=>e.do_store&&("body"===e.name||"title"===e.name||"heading"===e.name)));return Promise.all(o.map((e=>we(e,t,n,l,0,JSON.stringify(i),r))))}function ve(e,t,n,o,s,r,i){return de(this,void 0,void 0,(function*(){if(e.nextAction)return!1;const l=i.uiOptions.loadingIndicatorRender(ie,i,!1,!1);o||s.appendChild(l),e.lastElObserver&&e.lastElObserver.disconnect();const a=document.createDocumentFragment();(o?i.uiOptions.termInfoRender(ie,i,t.queryParts):[]).forEach((e=>a.appendChild(e)));const c=yield t.getNextN(i.uiOptions.resultsPerPage);if(e.nextAction)return!1;const d=yield i.uiOptions.resultsRender(ie,i,n,c,t);if(e.nextAction)return!1;d.length?d.forEach((e=>a.appendChild(e))):o&&a.appendChild(i.uiOptions.noResultsRender(ie,i));const u=a.lastElementChild;return o?(s.innerHTML="",r.v=ae(),s.append(r.v),s.append(a)):l.replaceWith(a),d.length&&(e.lastElObserver=new IntersectionObserver(((o,l)=>de(this,void 0,void 0,(function*(){o[0].isIntersecting&&(l.unobserve(u),yield ve(e,t,n,!1,s,r,i))}))),{rootMargin:"10px 10px 10px 10px"}),e.lastElObserver.observe(u)),!0}))}var xe;!function(e){e.Auto="auto",e.Dropdown="dropdown",e.Fullscreen="fullscreen",e.Target="target"}(xe||(xe={}));class Re{constructor(){this.wasResultsBlank=!0,this.isRunningQuery=!1}}var Te=function(e,t,n,o){return new(n||(n=Promise))((function(s,r){function i(e){try{a(o.next(e))}catch(e){r(e)}}function l(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}a((o=o.apply(e,t||[])).next())}))};let Oe=!1,Ce=!1,ke=!1;function Pe(e){return e.mode===xe.Auto&&!Oe||e.mode===xe.Dropdown}function Ee(e,t,n){e.setAttribute("role","combobox"),e.setAttribute("aria-expanded","true"),e.setAttribute("aria-owns",t.getAttribute("id")),t.setAttribute("role","listbox"),t.setAttribute("aria-label",n),t.setAttribute("aria-live","polite")}function Le(e,t){e.setAttribute("aria-autocomplete","list"),e.setAttribute("aria-controls",t),e.setAttribute("aria-activedescendant","morsels-list-selected")}function Se(e,t,n,o){const{uiOptions:s}=o;let r={v:ae()};const i=new Re;function l(l){var a;return Te(this,void 0,void 0,(function*(){const c=s.loadingIndicatorRender(ie,o,!1,i.wasResultsBlank);r.v.replaceWith(c),r.v=c;try{null===(a=i.currQuery)||void 0===a||a.free(),i.currQuery=yield n.getQuery(l);(yield ve(i,i.currQuery,n.morselsConfig,!0,t,r,o))&&(i.wasResultsBlank=!1),e.scrollTo({top:0}),t.scrollTo({top:0})}catch(e){throw console.error(e),t.innerHTML="",t.appendChild(s.errorRender(ie,o)),e}finally{if(i.nextAction){const e=i.nextAction;i.nextAction=void 0,yield e()}else i.isRunningQuery=!1}}))}n.setupPromise.then((()=>{i.nextAction&&(i.nextAction(),i.nextAction=void 0)}));let a=-1;return c=>{const d=s.preprocessQuery(c.target.value);if(clearTimeout(a),d.length)a=setTimeout((()=>{var a;i.wasResultsBlank&&!(null===(a=t.firstElementChild)||void 0===a?void 0:a.getAttribute(le))&&(t.innerHTML="",r.v=s.loadingIndicatorRender(ie,o,!n.isSetupDone,!0),t.appendChild(r.v),Pe(s)&&s.showDropdown(e,t,o)),i.isRunningQuery||!n.isSetupDone?i.nextAction=()=>l(d):(i.isRunningQuery=!0,l(d))}),s.inputDebounce);else{const n=()=>{t.innerHTML="",s.mode!==xe.Target&&(Pe(s)?s.hideDropdown(e,t,o):t.appendChild(s.fsBlankRender(ie,o))),i.isRunningQuery=!1,i.wasResultsBlank=!0};i.isRunningQuery?i.nextAction=n:n()}}}const Ae=function(e){const t=e.isMobileDevice||(()=>window.matchMedia("only screen and (max-width: 1024px)").matches);Oe=t(),function(e){if(e.searcherOptions=e.searcherOptions||{},!("url"in e.searcherOptions))throw new Error("Mandatory url parameter not specified");e.searcherOptions.url.endsWith("/")||(e.searcherOptions.url+="/"),"numberOfExpandedTerms"in e.searcherOptions||(e.searcherOptions.numberOfExpandedTerms=3),"useQueryTermProximity"in e.searcherOptions||(e.searcherOptions.useQueryTermProximity=!Oe),"resultLimit"in e.searcherOptions||(e.searcherOptions.resultLimit=null),e.uiOptions=e.uiOptions||{};const{uiOptions:t}=e;if(t.sourceFilesUrl&&!t.sourceFilesUrl.endsWith("/")&&(t.sourceFilesUrl+="/"),t.mode=t.mode||xe.Auto,t.mode===xe.Target&&("string"==typeof t.target&&(t.target=document.getElementById(t.target)),!t.target))throw new Error("'target' mode specified but no valid target option specified");if("input"in t&&"string"!=typeof t.input||(t.input=document.getElementById(t.input||"morsels-search")),[xe.Dropdown,xe.Target].includes(t.mode)&&!t.input)throw new Error("'dropdown' or 'target' mode specified but no input element found");"inputDebounce"in t||(t.inputDebounce=100),t.preprocessQuery=t.preprocessQuery||(e=>e),t.dropdownAlignment=t.dropdownAlignment||"bottom-end","string"==typeof t.fsContainer&&(t.fsContainer=document.getElementById(t.fsContainer)),t.fsContainer=t.fsContainer||document.getElementsByTagName("body")[0],t.resultsPerPage=t.resultsPerPage||8;const n=t.showDropdown||((e,n)=>{if(n.childElementCount){const o=e.lastElementChild,s=o.firstElementChild;o.style.display="block",Y(e,o,{placement:t.dropdownAlignment,middleware:[v({padding:10,mainAxis:!1}),x({apply({availableWidth:e,availableHeight:t}){Object.assign(n.style,{maxWidth:`min(${e}px, var(--morsels-dropdown-max-width))`,maxHeight:`min(${t}px, var(--morsels-dropdown-max-height))`})},padding:10}),h({element:s})]}).then((({x:e,y:t,middlewareData:n})=>{Object.assign(o.style,{left:`${e}px`,top:`${t}px`});const{x:r}=n.arrow;Object.assign(s.style,{left:null!=r?`${r}px`:""})}))}});t.showDropdown=(...e)=>{n(...e),Ce=!0};const o=t.hideDropdown||(e=>{e.lastElementChild.style.display="none"});t.hideDropdown=(...e)=>{o(...e),Ce=!1};const s=t.showFullscreen||((e,t,n)=>{n.appendChild(e);const o=e.querySelector("input.morsels-fs-input");o&&o.focus()});t.showFullscreen=(e,t,...n)=>{s(e,t,...n);const o=t.querySelector(".focus");o&&t.scrollTo({top:o.offsetTop-t.offsetTop-30}),ke=!0};const r=t.hideFullscreen||(e=>{e.remove()});t.hideFullscreen=(...e)=>{r(...e),ke=!1},t.label=t.label||"Search this site",t.fsPlaceholder=t.fsPlaceholder||"Search this site...",t.fsCloseText=t.fsCloseText||"Close",t.dropdownRootRender=t.dropdownRootRender||((e,t,n)=>{const o=e("ul",{id:"morsels-dropdown-list",class:"morsels-list"}),s=e("div",{class:"morsels-root"},n,e("div",{class:"morsels-inner-root",style:"display: none;"},e("div",{class:"morsels-input-dropdown-separator"}),o));return Le(n,"morsels-dropdown-list"),Ee(s,o,t.uiOptions.label),{dropdownRoot:s,dropdownListContainer:o}}),t.fsRootRender=t.fsRootRender||((e,n,o)=>{const s=e("input",{class:"morsels-fs-input",type:"search",placeholder:n.uiOptions.fsPlaceholder,autocomplete:"false","aria-labelledby":"morsels-fs-label"});Le(s,"morsels-fs-list");const r=e("button",{class:"morsels-input-close-fs"},n.uiOptions.fsCloseText);r.onclick=e=>{e.preventDefault(),o()};const i=e("ul",{id:"morsels-fs-list",class:"morsels-list","aria-labelledby":"morsels-fs-label"}),l=e("div",{class:"morsels-root morsels-fs-root"},e("form",{class:"morsels-fs-input-button-wrapper"},e("label",{id:"morsels-fs-label",for:"morsels-fs-input",style:"display: none"},n.uiOptions.label),s,r),i);l.onclick=e=>e.stopPropagation(),l.onmousedown=e=>e.stopPropagation(),Ee(l,i,n.uiOptions.label);const a=e("div",{class:"morsels-fs-backdrop"},l);return a.onmousedown=()=>{t.hideFullscreen(a,i,l,n)},a.onkeyup=e=>{"Escape"===e.code&&(e.stopPropagation(),t.hideFullscreen(a,i,l,n))},{root:a,listContainer:i,input:s}}),t.errorRender=t.errorRender||(e=>e("div",{class:"morsels-error"},"Oops! Something went wrong... 🙁")),t.noResultsRender=t.noResultsRender||(e=>e("div",{class:"morsels-no-results"},"No results found")),t.fsBlankRender=t.fsBlankRender||(e=>e("div",{class:"morsels-fs-blank"},"Start Searching Above!")),t.loadingIndicatorRender||(t.loadingIndicatorRender=(e,t,n,o)=>{const s=e("span",{class:"morsels-loading-indicator"});if(n){const t=e("div",{class:"morsels-initialising-text"},"... Initialising ...");return e("div",{class:"morsels-initialising"},t,s)}return o||s.classList.add("morsels-loading-indicator-subsequent"),s});const i=t.loadingIndicatorRender;t.loadingIndicatorRender=(...e)=>{const t=i(...e);return t.setAttribute(le,"true"),t},t.termInfoRender=t.termInfoRender||(()=>[]),t.resultsRender=t.resultsRender||be,t.resultsRenderOpts=t.resultsRenderOpts||{},t.resultsRenderOpts.listItemRender=t.resultsRenderOpts.listItemRender||((t,n,o,s,r,i)=>{const l=t("a",{class:"morsels-link"},t("div",{class:"morsels-title"},r),...i);if(s){let t=s;if(n.uiOptions.resultsRenderOpts.addSearchedTerms){const n=ce(s);n.searchParams.append(e.uiOptions.resultsRenderOpts.addSearchedTerms,o),t=n.toString()}l.setAttribute("href",t)}return t("li",{class:"morsels-list-item",role:"option"},l)}),t.resultsRenderOpts.headingBodyRender=t.resultsRenderOpts.headingBodyRender||((e,t,n,o,s)=>{const r=e("a",{class:"morsels-heading-body"},e("div",{class:"morsels-heading"},...n),e("div",{class:"morsels-bodies"},e("div",{class:"morsels-body"},...o)));return s&&r.setAttribute("href",s),r}),t.resultsRenderOpts.bodyOnlyRender=t.resultsRenderOpts.bodyOnlyRender||((e,t,n)=>e("div",{class:"morsels-body"},...n)),t.resultsRenderOpts.highlightRender=t.resultsRenderOpts.highlightRender||((e,t,n)=>e("span",{class:"morsels-highlight"},n)),e.otherOptions=e.otherOptions||{}}(e);const{uiOptions:n}=e,o=new oe(e.searcherOptions),{root:s,listContainer:r,input:i}=n.fsRootRender(ie,e,(()=>n.hideFullscreen(s,r,n.fsContainer,e)));let l;i.addEventListener("input",Se(s,r,o,e)),r.appendChild(n.fsBlankRender(ie,e));const{input:a}=n;if(!a||n.mode!==xe.Auto&&n.mode!==xe.Dropdown){if(a&&n.mode===xe.Fullscreen)a.addEventListener("focus",(()=>{n.showFullscreen(s,r,n.fsContainer,e)}));else if(a&&n.mode===xe.Target){a.addEventListener("input",Se(n.target,n.target,o,e));let t=n.target.getAttribute("id");t||(n.target.setAttribute("id","morsels-target-list"),t="morsels-target-list"),Le(a,t),Ee(a,n.target,n.label)}}else{const i=a.parentElement;a.remove();const{dropdownRoot:c,dropdownListContainer:d}=n.dropdownRootRender(ie,e,a);function u(){n.hideDropdown(c,l,e),document.activeElement===a&&n.showDropdown(c,l,e)}let f;l=d,i.appendChild(c),a.addEventListener("input",Se(c,l,o,e)),window.addEventListener("resize",(()=>{clearTimeout(f),f=setTimeout((()=>{n.mode!==xe.Dropdown?(Oe=t(),Oe?n.hideDropdown(c,l,e):(n.hideFullscreen(s,r,n.fsContainer,e),u())):u()}),10)})),a.addEventListener("blur",(()=>{Pe(n)&&setTimeout((()=>{let t=document.activeElement;for(;t;)if(t=t.parentElement,t===c)return void a.focus();n.hideDropdown(c,l,e)}),100)})),a.addEventListener("focus",(()=>{Pe(n)?n.showDropdown(c,l,e):n.showFullscreen(s,r,n.fsContainer,e)}))}function c(e){if(!["ArrowDown","ArrowUp","Home","End","Enter"].includes(e.key))return;let t,o=e=>{t.scrollTo({top:e.offsetTop-t.offsetTop-30})};if(Pe(n)){if(!Ce)return;t=l}else if(n.mode===xe.Target)t=n.target,o=e=>{e.scrollIntoView({block:"center"})};else{if(!ke)return;t=r}const s=t.querySelector(".focus");function i(e){s&&(s.classList.remove("focus"),s.removeAttribute("aria-selected"),s.removeAttribute("id")),e.classList.add("focus"),e.setAttribute("aria-selected","true"),e.setAttribute("id","morsels-list-selected"),o(e)}function a(e,t){e&&!e.getAttribute(le)?i(e):t&&!t.getAttribute(le)&&i(t)}const c=t.firstElementChild,d=t.lastElementChild;if("ArrowDown"===e.key)s?a(s.nextElementSibling,null):a(c,null==c?void 0:c.nextElementSibling);else if("ArrowUp"===e.key)s&&a(s.previousElementSibling,null);else if("Home"===e.key)a(c,null==c?void 0:c.nextElementSibling);else if("End"===e.key)a(d,null==d?void 0:d.previousElementSibling);else if("Enter"===e.key&&s){const e=s.querySelector("a[href]");e&&(window.location.href=e.getAttribute("href"))}e.preventDefault()}return null==a||a.addEventListener("keydown",c),i.addEventListener("keydown",c),{showFullscreen:()=>{n.showFullscreen(s,r,n.fsContainer,e)},hideFullscreen:()=>{n.hideFullscreen(s,r,n.fsContainer,e)}}};return t=t.default})()}));